<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>scGPS introduction â€¢ scGPS</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="scGPS introduction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scGPS</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette.html">scGPS introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="vignette_files/htmlwidgets-1.2/htmlwidgets.js"></script><script src="vignette_files/d3-4.5.0/d3.min.js"></script><script src="vignette_files/sankey-1/sankey.js"></script><script src="vignette_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>scGPS introduction</h1>
                        <h4 class="author">Quan Nguyen</h4>
            
            <h4 class="date">2018-05-05</h4>
      
      
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<div id="installation-instruction" class="section level1">
<h1 class="hasAnchor">
<a href="#installation-instruction" class="anchor"></a>1. Installation instruction</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Prior to installing scGPS you need to install the SummarizedExperiment</span>
<span class="co"># bioconductor package as the following</span>
<span class="co"># source('https://bioconductor.org/biocLite.R') biocLite('SummarizedExperiment')</span>

<span class="co"># To install scGPS from github (Depending on the configuration of the local</span>
<span class="co"># computer or HPC, possible custom C++ compilation may be required - see</span>
<span class="co"># installation trouble-shootings below)</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"IMB-Computational-Genomics-Lab/scGPS"</span>)

<span class="co"># for C++ compilation trouble-shooting, manual download and installation can be</span>
<span class="co"># done from github</span>

git clone https<span class="op">:</span><span class="er">//</span>github.com<span class="op">/</span>IMB<span class="op">-</span>Computational<span class="op">-</span>Genomics<span class="op">-</span>Lab<span class="op">/</span>scGPS

<span class="co"># then check in scGPS/src if any of the precompiled (e.g.  those with *.so and</span>
<span class="co"># *.o) files exist and delete them before recompiling</span>

<span class="co"># create a Makevars file in the scGPS/src with one line: PKG_LIBS =</span>
<span class="co"># $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)</span>

<span class="co"># then with the scGPS as the R working directory, manually recompile scGPS in R</span>
<span class="co"># using devtools to load and install functions</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/document">document</a></span>()
<span class="co"># update the NAMESPACE using the update_NAMESPACE.sh </span>
sh update_NAMESPACE.sh 
<span class="co">#for window system, to update the NAMESPACE: copy and paste the content of the file NAMESPACE_toAdd_cpp_links to end of the file NAMESPACE </span>

<span class="co">#load the package to the workspace </span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/load_all">load_all</a></span>()</code></pre></div>
</div>
<div id="a-simple-workflow-of-the-scgps" class="section level1">
<h1 class="hasAnchor">
<a href="#a-simple-workflow-of-the-scgps" class="anchor"></a>2. A simple workflow of the scGPS:</h1>
<p><em>The purpose of this workflow is to solve the following task: given a mixed population with known subpopulations, estimate transition scores between these subpopulation</em></p>
<div id="setup-scgps-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#setup-scgps-objects" class="anchor"></a>2.1 Setup scGPS objects</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># load mixed population 1 (loaded from sample1 dataset, named it as day2)</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/load_all">load_all</a></span>() 

day2 &lt;-<span class="st"> </span>sample1

mixedpop1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/NewscGPS_SME.html">NewscGPS_SME</a></span>(<span class="dt">ExpressionMatrix =</span> day2<span class="op">$</span>dat2_counts, <span class="dt">GeneMetadata =</span> day2<span class="op">$</span>dat2geneInfo, 
    <span class="dt">CellMetadata =</span> day2<span class="op">$</span>dat2_clusters)

<span class="co"># load mixed population 2 (loaded from sample2 dataset, named it as day5)</span>
day5 &lt;-<span class="st"> </span>sample2
mixedpop2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/NewscGPS_SME.html">NewscGPS_SME</a></span>(<span class="dt">ExpressionMatrix =</span> day5<span class="op">$</span>dat5_counts, <span class="dt">GeneMetadata =</span> day5<span class="op">$</span>dat5geneInfo, 
    <span class="dt">CellMetadata =</span> day5<span class="op">$</span>dat5_clusters)

<span class="co"># load gene list (this can be any lists of user selected genes)</span>
genes &lt;-<span class="st"> </span>GeneList
genes &lt;-<span class="st"> </span>genes<span class="op">$</span>Merged_unique

<span class="co"># select a subpopulation</span>
c_selectID &lt;-<span class="st"> </span><span class="dv">1</span></code></pre></div>
</div>
<div id="run-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#run-predictions" class="anchor"></a>2.2 Run predictions</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># run the test bootstrap</span>

LSOLDA_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">2</span>, <span class="dt">mixedpop1 =</span> mixedpop1, 
    <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes =</span> genes, c_selectID, <span class="dt">listData =</span> <span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev    Lambda</span>
<span class="co">#&gt;   [1,]  0 -2.563e-15 2.495e-01</span>
<span class="co">#&gt;   [2,]  1  3.066e-02 2.273e-01</span>
<span class="co">#&gt;   [3,]  1  5.693e-02 2.071e-01</span>
<span class="co">#&gt;   [4,]  1  8.000e-02 1.887e-01</span>
<span class="co">#&gt;   [5,]  3  1.057e-01 1.720e-01</span>
<span class="co">#&gt;   [6,]  6  1.399e-01 1.567e-01</span>
<span class="co">#&gt;   [7,]  6  1.748e-01 1.428e-01</span>
<span class="co">#&gt;   [8,]  6  2.054e-01 1.301e-01</span>
<span class="co">#&gt;   [9,]  6  2.324e-01 1.185e-01</span>
<span class="co">#&gt;  [10,]  8  2.587e-01 1.080e-01</span>
<span class="co">#&gt;  [11,]  9  2.848e-01 9.840e-02</span>
<span class="co">#&gt;  [12,]  9  3.093e-01 8.966e-02</span>
<span class="co">#&gt;  [13,] 10  3.314e-01 8.169e-02</span>
<span class="co">#&gt;  [14,] 11  3.520e-01 7.443e-02</span>
<span class="co">#&gt;  [15,] 12  3.712e-01 6.782e-02</span>
<span class="co">#&gt;  [16,] 13  3.888e-01 6.180e-02</span>
<span class="co">#&gt;  [17,] 14  4.075e-01 5.631e-02</span>
<span class="co">#&gt;  [18,] 16  4.264e-01 5.130e-02</span>
<span class="co">#&gt;  [19,] 18  4.459e-01 4.675e-02</span>
<span class="co">#&gt;  [20,] 21  4.649e-01 4.259e-02</span>
<span class="co">#&gt;  [21,] 22  4.844e-01 3.881e-02</span>
<span class="co">#&gt;  [22,] 23  5.028e-01 3.536e-02</span>
<span class="co">#&gt;  [23,] 25  5.206e-01 3.222e-02</span>
<span class="co">#&gt;  [24,] 29  5.385e-01 2.936e-02</span>
<span class="co">#&gt;  [25,] 31  5.573e-01 2.675e-02</span>
<span class="co">#&gt;  [26,] 33  5.760e-01 2.437e-02</span>
<span class="co">#&gt;  [27,] 34  5.945e-01 2.221e-02</span>
<span class="co">#&gt;  [28,] 36  6.122e-01 2.024e-02</span>
<span class="co">#&gt;  [29,] 37  6.292e-01 1.844e-02</span>
<span class="co">#&gt;  [30,] 39  6.451e-01 1.680e-02</span>
<span class="co">#&gt;  [31,] 42  6.604e-01 1.531e-02</span>
<span class="co">#&gt;  [32,] 44  6.751e-01 1.395e-02</span>
<span class="co">#&gt;  [33,] 48  6.913e-01 1.271e-02</span>
<span class="co">#&gt;  [34,] 49  7.074e-01 1.158e-02</span>
<span class="co">#&gt;  [35,] 51  7.232e-01 1.055e-02</span>
<span class="co">#&gt;  [36,] 51  7.381e-01 9.613e-03</span>
<span class="co">#&gt;  [37,] 52  7.528e-01 8.759e-03</span>
<span class="co">#&gt;  [38,] 54  7.671e-01 7.981e-03</span>
<span class="co">#&gt;  [39,] 57  7.810e-01 7.272e-03</span>
<span class="co">#&gt;  [40,] 58  7.942e-01 6.626e-03</span>
<span class="co">#&gt;  [41,] 58  8.064e-01 6.038e-03</span>
<span class="co">#&gt;  [42,] 59  8.180e-01 5.501e-03</span>
<span class="co">#&gt;  [43,] 60  8.289e-01 5.012e-03</span>
<span class="co">#&gt;  [44,] 61  8.395e-01 4.567e-03</span>
<span class="co">#&gt;  [45,] 61  8.495e-01 4.161e-03</span>
<span class="co">#&gt;  [46,] 62  8.589e-01 3.792e-03</span>
<span class="co">#&gt;  [47,] 61  8.677e-01 3.455e-03</span>
<span class="co">#&gt;  [48,] 62  8.759e-01 3.148e-03</span>
<span class="co">#&gt;  [49,] 64  8.838e-01 2.868e-03</span>
<span class="co">#&gt;  [50,] 64  8.913e-01 2.614e-03</span>
<span class="co">#&gt;  [51,] 66  8.984e-01 2.381e-03</span>
<span class="co">#&gt;  [52,] 64  9.051e-01 2.170e-03</span>
<span class="co">#&gt;  [53,] 64  9.114e-01 1.977e-03</span>
<span class="co">#&gt;  [54,] 64  9.174e-01 1.801e-03</span>
<span class="co">#&gt;  [55,] 65  9.231e-01 1.641e-03</span>
<span class="co">#&gt;  [56,] 64  9.286e-01 1.496e-03</span>
<span class="co">#&gt;  [57,] 66  9.337e-01 1.363e-03</span>
<span class="co">#&gt;  [58,] 66  9.387e-01 1.242e-03</span>
<span class="co">#&gt;  [59,] 65  9.433e-01 1.131e-03</span>
<span class="co">#&gt;  [60,] 65  9.477e-01 1.031e-03</span>
<span class="co">#&gt;  [61,] 63  9.518e-01 9.392e-04</span>
<span class="co">#&gt;  [62,] 64  9.557e-01 8.558e-04</span>
<span class="co">#&gt;  [63,] 64  9.593e-01 7.798e-04</span>
<span class="co">#&gt;  [64,] 63  9.627e-01 7.105e-04</span>
<span class="co">#&gt;  [65,] 63  9.658e-01 6.474e-04</span>
<span class="co">#&gt;  [66,] 64  9.687e-01 5.899e-04</span>
<span class="co">#&gt;  [67,] 65  9.714e-01 5.375e-04</span>
<span class="co">#&gt;  [68,] 65  9.739e-01 4.897e-04</span>
<span class="co">#&gt;  [69,] 65  9.762e-01 4.462e-04</span>
<span class="co">#&gt;  [70,] 65  9.783e-01 4.066e-04</span>
<span class="co">#&gt;  [71,] 66  9.802e-01 3.705e-04</span>
<span class="co">#&gt;  [72,] 66  9.819e-01 3.375e-04</span>
<span class="co">#&gt;  [73,] 65  9.835e-01 3.076e-04</span>
<span class="co">#&gt;  [74,] 65  9.850e-01 2.802e-04</span>
<span class="co">#&gt;  [75,] 65  9.863e-01 2.553e-04</span>
<span class="co">#&gt;  [76,] 65  9.875e-01 2.327e-04</span>
<span class="co">#&gt;  [77,] 66  9.886e-01 2.120e-04</span>
<span class="co">#&gt;  [78,] 66  9.896e-01 1.932e-04</span>
<span class="co">#&gt;  [79,] 66  9.906e-01 1.760e-04</span>
<span class="co">#&gt;  [80,] 66  9.914e-01 1.604e-04</span>
<span class="co">#&gt;  [81,] 66  9.922e-01 1.461e-04</span>
<span class="co">#&gt;  [82,] 66  9.929e-01 1.331e-04</span>
<span class="co">#&gt;  [83,] 65  9.935e-01 1.213e-04</span>
<span class="co">#&gt;  [84,] 65  9.941e-01 1.105e-04</span>
<span class="co">#&gt;  [85,] 65  9.946e-01 1.007e-04</span>
<span class="co">#&gt;  [86,] 65  9.950e-01 9.177e-05</span>
<span class="co">#&gt;  [87,] 65  9.955e-01 8.361e-05</span>
<span class="co">#&gt;  [88,] 66  9.959e-01 7.619e-05</span>
<span class="co">#&gt;  [89,] 65  9.962e-01 6.942e-05</span>
<span class="co">#&gt;  [90,] 65  9.966e-01 6.325e-05</span>
<span class="co">#&gt;  [91,] 65  9.968e-01 5.763e-05</span>
<span class="co">#&gt;  [92,] 66  9.972e-01 5.251e-05</span>
<span class="co">#&gt;  [93,] 65  9.974e-01 4.785e-05</span>
<span class="co">#&gt;  [94,] 65  9.976e-01 4.360e-05</span>
<span class="co">#&gt;  [95,] 65  9.978e-01 3.972e-05</span>
<span class="co">#&gt;  [96,] 66  9.980e-01 3.619e-05</span>
<span class="co">#&gt;  [97,] 67  9.982e-01 3.298e-05</span>
<span class="co">#&gt;  [98,] 67  9.983e-01 3.005e-05</span>
<span class="co">#&gt;  [99,] 67  9.985e-01 2.738e-05</span>
<span class="co">#&gt; [100,] 67  9.986e-01 2.495e-05</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev    Lambda</span>
<span class="co">#&gt;   [1,]  0 -2.563e-15 2.355e-01</span>
<span class="co">#&gt;   [2,]  2  3.870e-02 2.146e-01</span>
<span class="co">#&gt;   [3,]  3  7.195e-02 1.955e-01</span>
<span class="co">#&gt;   [4,]  4  1.061e-01 1.781e-01</span>
<span class="co">#&gt;   [5,]  4  1.385e-01 1.623e-01</span>
<span class="co">#&gt;   [6,]  5  1.697e-01 1.479e-01</span>
<span class="co">#&gt;   [7,]  6  2.001e-01 1.348e-01</span>
<span class="co">#&gt;   [8,]  7  2.280e-01 1.228e-01</span>
<span class="co">#&gt;   [9,]  8  2.544e-01 1.119e-01</span>
<span class="co">#&gt;  [10,]  8  2.798e-01 1.019e-01</span>
<span class="co">#&gt;  [11,]  8  3.025e-01 9.289e-02</span>
<span class="co">#&gt;  [12,]  8  3.228e-01 8.464e-02</span>
<span class="co">#&gt;  [13,] 11  3.441e-01 7.712e-02</span>
<span class="co">#&gt;  [14,] 12  3.647e-01 7.027e-02</span>
<span class="co">#&gt;  [15,] 13  3.841e-01 6.402e-02</span>
<span class="co">#&gt;  [16,] 15  4.019e-01 5.834e-02</span>
<span class="co">#&gt;  [17,] 16  4.195e-01 5.315e-02</span>
<span class="co">#&gt;  [18,] 17  4.372e-01 4.843e-02</span>
<span class="co">#&gt;  [19,] 20  4.555e-01 4.413e-02</span>
<span class="co">#&gt;  [20,] 23  4.755e-01 4.021e-02</span>
<span class="co">#&gt;  [21,] 26  4.952e-01 3.664e-02</span>
<span class="co">#&gt;  [22,] 27  5.168e-01 3.338e-02</span>
<span class="co">#&gt;  [23,] 29  5.395e-01 3.042e-02</span>
<span class="co">#&gt;  [24,] 35  5.615e-01 2.771e-02</span>
<span class="co">#&gt;  [25,] 36  5.828e-01 2.525e-02</span>
<span class="co">#&gt;  [26,] 37  6.023e-01 2.301e-02</span>
<span class="co">#&gt;  [27,] 40  6.209e-01 2.096e-02</span>
<span class="co">#&gt;  [28,] 41  6.389e-01 1.910e-02</span>
<span class="co">#&gt;  [29,] 41  6.561e-01 1.741e-02</span>
<span class="co">#&gt;  [30,] 43  6.723e-01 1.586e-02</span>
<span class="co">#&gt;  [31,] 47  6.884e-01 1.445e-02</span>
<span class="co">#&gt;  [32,] 47  7.038e-01 1.317e-02</span>
<span class="co">#&gt;  [33,] 52  7.189e-01 1.200e-02</span>
<span class="co">#&gt;  [34,] 53  7.338e-01 1.093e-02</span>
<span class="co">#&gt;  [35,] 55  7.479e-01 9.960e-03</span>
<span class="co">#&gt;  [36,] 60  7.620e-01 9.075e-03</span>
<span class="co">#&gt;  [37,] 64  7.764e-01 8.269e-03</span>
<span class="co">#&gt;  [38,] 64  7.903e-01 7.534e-03</span>
<span class="co">#&gt;  [39,] 65  8.033e-01 6.865e-03</span>
<span class="co">#&gt;  [40,] 65  8.160e-01 6.255e-03</span>
<span class="co">#&gt;  [41,] 66  8.280e-01 5.699e-03</span>
<span class="co">#&gt;  [42,] 66  8.393e-01 5.193e-03</span>
<span class="co">#&gt;  [43,] 68  8.501e-01 4.732e-03</span>
<span class="co">#&gt;  [44,] 67  8.606e-01 4.311e-03</span>
<span class="co">#&gt;  [45,] 67  8.705e-01 3.928e-03</span>
<span class="co">#&gt;  [46,] 67  8.798e-01 3.579e-03</span>
<span class="co">#&gt;  [47,] 67  8.886e-01 3.261e-03</span>
<span class="co">#&gt;  [48,] 68  8.969e-01 2.972e-03</span>
<span class="co">#&gt;  [49,] 69  9.049e-01 2.708e-03</span>
<span class="co">#&gt;  [50,] 67  9.125e-01 2.467e-03</span>
<span class="co">#&gt;  [51,] 67  9.193e-01 2.248e-03</span>
<span class="co">#&gt;  [52,] 69  9.259e-01 2.048e-03</span>
<span class="co">#&gt;  [53,] 69  9.321e-01 1.866e-03</span>
<span class="co">#&gt;  [54,] 69  9.378e-01 1.701e-03</span>
<span class="co">#&gt;  [55,] 69  9.432e-01 1.549e-03</span>
<span class="co">#&gt;  [56,] 69  9.480e-01 1.412e-03</span>
<span class="co">#&gt;  [57,] 70  9.526e-01 1.286e-03</span>
<span class="co">#&gt;  [58,] 71  9.567e-01 1.172e-03</span>
<span class="co">#&gt;  [59,] 71  9.605e-01 1.068e-03</span>
<span class="co">#&gt;  [60,] 69  9.639e-01 9.731e-04</span>
<span class="co">#&gt;  [61,] 70  9.671e-01 8.867e-04</span>
<span class="co">#&gt;  [62,] 70  9.700e-01 8.079e-04</span>
<span class="co">#&gt;  [63,] 70  9.727e-01 7.361e-04</span>
<span class="co">#&gt;  [64,] 70  9.751e-01 6.707e-04</span>
<span class="co">#&gt;  [65,] 70  9.773e-01 6.111e-04</span>
<span class="co">#&gt;  [66,] 71  9.793e-01 5.568e-04</span>
<span class="co">#&gt;  [67,] 71  9.811e-01 5.074e-04</span>
<span class="co">#&gt;  [68,] 71  9.828e-01 4.623e-04</span>
<span class="co">#&gt;  [69,] 71  9.843e-01 4.212e-04</span>
<span class="co">#&gt;  [70,] 72  9.857e-01 3.838e-04</span>
<span class="co">#&gt;  [71,] 72  9.870e-01 3.497e-04</span>
<span class="co">#&gt;  [72,] 72  9.881e-01 3.186e-04</span>
<span class="co">#&gt;  [73,] 72  9.892e-01 2.903e-04</span>
<span class="co">#&gt;  [74,] 72  9.901e-01 2.645e-04</span>
<span class="co">#&gt;  [75,] 72  9.910e-01 2.410e-04</span>
<span class="co">#&gt;  [76,] 72  9.918e-01 2.196e-04</span>
<span class="co">#&gt;  [77,] 72  9.925e-01 2.001e-04</span>
<span class="co">#&gt;  [78,] 71  9.932e-01 1.823e-04</span>
<span class="co">#&gt;  [79,] 71  9.938e-01 1.661e-04</span>
<span class="co">#&gt;  [80,] 71  9.944e-01 1.514e-04</span>
<span class="co">#&gt;  [81,] 71  9.949e-01 1.379e-04</span>
<span class="co">#&gt;  [82,] 71  9.953e-01 1.257e-04</span>
<span class="co">#&gt;  [83,] 71  9.957e-01 1.145e-04</span>
<span class="co">#&gt;  [84,] 71  9.961e-01 1.043e-04</span>
<span class="co">#&gt;  [85,] 71  9.964e-01 9.507e-05</span>
<span class="co">#&gt;  [86,] 71  9.968e-01 8.663e-05</span>
<span class="co">#&gt;  [87,] 71  9.970e-01 7.893e-05</span>
<span class="co">#&gt;  [88,] 71  9.973e-01 7.192e-05</span>
<span class="co">#&gt;  [89,] 71  9.975e-01 6.553e-05</span>
<span class="co">#&gt;  [90,] 71  9.978e-01 5.971e-05</span>
<span class="co">#&gt;  [91,] 71  9.980e-01 5.440e-05</span>
<span class="co">#&gt;  [92,] 71  9.981e-01 4.957e-05</span>
<span class="co">#&gt;  [93,] 71  9.983e-01 4.517e-05</span>
<span class="co">#&gt;  [94,] 71  9.985e-01 4.115e-05</span>
<span class="co">#&gt;  [95,] 72  9.986e-01 3.750e-05</span>
<span class="co">#&gt;  [96,] 72  9.987e-01 3.417e-05</span>
<span class="co">#&gt;  [97,] 72  9.988e-01 3.113e-05</span>
<span class="co">#&gt;  [98,] 72  9.989e-01 2.837e-05</span>
<span class="co">#&gt;  [99,] 72  9.990e-01 2.585e-05</span>
<span class="co">#&gt; [1] "done bootstrap 2"</span></code></pre></div>
</div>
<div id="summarise-results" class="section level2">
<h2 class="hasAnchor">
<a href="#summarise-results" class="anchor"></a>2.3 Summarise results</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
LSOLDA_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">2</span>, <span class="dt">mixedpop1 =</span> mixedpop1, 
    <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes =</span> genes, c_selectID, <span class="dt">listData =</span> <span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev    Lambda</span>
<span class="co">#&gt;   [1,]  0 -2.563e-15 2.933e-01</span>
<span class="co">#&gt;   [2,]  1  4.230e-02 2.672e-01</span>
<span class="co">#&gt;   [3,]  1  7.816e-02 2.435e-01</span>
<span class="co">#&gt;   [4,]  1  1.091e-01 2.219e-01</span>
<span class="co">#&gt;   [5,]  1  1.360e-01 2.022e-01</span>
<span class="co">#&gt;   [6,]  2  1.658e-01 1.842e-01</span>
<span class="co">#&gt;   [7,]  3  1.939e-01 1.678e-01</span>
<span class="co">#&gt;   [8,]  3  2.210e-01 1.529e-01</span>
<span class="co">#&gt;   [9,]  4  2.453e-01 1.393e-01</span>
<span class="co">#&gt;  [10,]  4  2.699e-01 1.270e-01</span>
<span class="co">#&gt;  [11,]  5  2.924e-01 1.157e-01</span>
<span class="co">#&gt;  [12,]  5  3.142e-01 1.054e-01</span>
<span class="co">#&gt;  [13,]  7  3.351e-01 9.604e-02</span>
<span class="co">#&gt;  [14,]  7  3.547e-01 8.751e-02</span>
<span class="co">#&gt;  [15,]  8  3.739e-01 7.973e-02</span>
<span class="co">#&gt;  [16,]  9  3.926e-01 7.265e-02</span>
<span class="co">#&gt;  [17,] 10  4.103e-01 6.620e-02</span>
<span class="co">#&gt;  [18,] 12  4.270e-01 6.032e-02</span>
<span class="co">#&gt;  [19,] 13  4.440e-01 5.496e-02</span>
<span class="co">#&gt;  [20,] 15  4.623e-01 5.008e-02</span>
<span class="co">#&gt;  [21,] 16  4.812e-01 4.563e-02</span>
<span class="co">#&gt;  [22,] 21  5.005e-01 4.157e-02</span>
<span class="co">#&gt;  [23,] 22  5.194e-01 3.788e-02</span>
<span class="co">#&gt;  [24,] 23  5.368e-01 3.451e-02</span>
<span class="co">#&gt;  [25,] 26  5.535e-01 3.145e-02</span>
<span class="co">#&gt;  [26,] 26  5.688e-01 2.865e-02</span>
<span class="co">#&gt;  [27,] 28  5.832e-01 2.611e-02</span>
<span class="co">#&gt;  [28,] 30  5.967e-01 2.379e-02</span>
<span class="co">#&gt;  [29,] 31  6.116e-01 2.168e-02</span>
<span class="co">#&gt;  [30,] 32  6.263e-01 1.975e-02</span>
<span class="co">#&gt;  [31,] 37  6.420e-01 1.800e-02</span>
<span class="co">#&gt;  [32,] 39  6.576e-01 1.640e-02</span>
<span class="co">#&gt;  [33,] 41  6.730e-01 1.494e-02</span>
<span class="co">#&gt;  [34,] 45  6.881e-01 1.361e-02</span>
<span class="co">#&gt;  [35,] 48  7.034e-01 1.240e-02</span>
<span class="co">#&gt;  [36,] 48  7.177e-01 1.130e-02</span>
<span class="co">#&gt;  [37,] 47  7.309e-01 1.030e-02</span>
<span class="co">#&gt;  [38,] 48  7.432e-01 9.383e-03</span>
<span class="co">#&gt;  [39,] 50  7.549e-01 8.550e-03</span>
<span class="co">#&gt;  [40,] 50  7.658e-01 7.790e-03</span>
<span class="co">#&gt;  [41,] 51  7.758e-01 7.098e-03</span>
<span class="co">#&gt;  [42,] 53  7.858e-01 6.467e-03</span>
<span class="co">#&gt;  [43,] 53  7.957e-01 5.893e-03</span>
<span class="co">#&gt;  [44,] 53  8.050e-01 5.369e-03</span>
<span class="co">#&gt;  [45,] 54  8.140e-01 4.892e-03</span>
<span class="co">#&gt;  [46,] 55  8.229e-01 4.458e-03</span>
<span class="co">#&gt;  [47,] 57  8.314e-01 4.062e-03</span>
<span class="co">#&gt;  [48,] 62  8.401e-01 3.701e-03</span>
<span class="co">#&gt;  [49,] 63  8.496e-01 3.372e-03</span>
<span class="co">#&gt;  [50,] 63  8.588e-01 3.073e-03</span>
<span class="co">#&gt;  [51,] 66  8.677e-01 2.800e-03</span>
<span class="co">#&gt;  [52,] 65  8.763e-01 2.551e-03</span>
<span class="co">#&gt;  [53,] 65  8.846e-01 2.324e-03</span>
<span class="co">#&gt;  [54,] 66  8.923e-01 2.118e-03</span>
<span class="co">#&gt;  [55,] 65  8.998e-01 1.930e-03</span>
<span class="co">#&gt;  [56,] 65  9.068e-01 1.758e-03</span>
<span class="co">#&gt;  [57,] 69  9.138e-01 1.602e-03</span>
<span class="co">#&gt;  [58,] 70  9.207e-01 1.460e-03</span>
<span class="co">#&gt;  [59,] 70  9.272e-01 1.330e-03</span>
<span class="co">#&gt;  [60,] 70  9.332e-01 1.212e-03</span>
<span class="co">#&gt;  [61,] 70  9.389e-01 1.104e-03</span>
<span class="co">#&gt;  [62,] 71  9.442e-01 1.006e-03</span>
<span class="co">#&gt;  [63,] 71  9.491e-01 9.167e-04</span>
<span class="co">#&gt;  [64,] 71  9.536e-01 8.353e-04</span>
<span class="co">#&gt;  [65,] 71  9.577e-01 7.611e-04</span>
<span class="co">#&gt;  [66,] 70  9.615e-01 6.935e-04</span>
<span class="co">#&gt;  [67,] 71  9.650e-01 6.319e-04</span>
<span class="co">#&gt;  [68,] 72  9.681e-01 5.757e-04</span>
<span class="co">#&gt;  [69,] 73  9.710e-01 5.246e-04</span>
<span class="co">#&gt;  [70,] 73  9.736e-01 4.780e-04</span>
<span class="co">#&gt;  [71,] 72  9.761e-01 4.355e-04</span>
<span class="co">#&gt;  [72,] 72  9.782e-01 3.968e-04</span>
<span class="co">#&gt;  [73,] 72  9.802e-01 3.616e-04</span>
<span class="co">#&gt;  [74,] 73  9.820e-01 3.295e-04</span>
<span class="co">#&gt;  [75,] 72  9.836e-01 3.002e-04</span>
<span class="co">#&gt;  [76,] 72  9.851e-01 2.735e-04</span>
<span class="co">#&gt;  [77,] 72  9.864e-01 2.492e-04</span>
<span class="co">#&gt;  [78,] 71  9.876e-01 2.271e-04</span>
<span class="co">#&gt;  [79,] 71  9.887e-01 2.069e-04</span>
<span class="co">#&gt;  [80,] 71  9.897e-01 1.885e-04</span>
<span class="co">#&gt;  [81,] 71  9.906e-01 1.718e-04</span>
<span class="co">#&gt;  [82,] 71  9.915e-01 1.565e-04</span>
<span class="co">#&gt;  [83,] 71  9.922e-01 1.426e-04</span>
<span class="co">#&gt;  [84,] 71  9.929e-01 1.299e-04</span>
<span class="co">#&gt;  [85,] 71  9.936e-01 1.184e-04</span>
<span class="co">#&gt;  [86,] 71  9.941e-01 1.079e-04</span>
<span class="co">#&gt;  [87,] 71  9.946e-01 9.830e-05</span>
<span class="co">#&gt;  [88,] 71  9.951e-01 8.957e-05</span>
<span class="co">#&gt;  [89,] 71  9.956e-01 8.161e-05</span>
<span class="co">#&gt;  [90,] 71  9.959e-01 7.436e-05</span>
<span class="co">#&gt;  [91,] 71  9.963e-01 6.775e-05</span>
<span class="co">#&gt;  [92,] 71  9.966e-01 6.174e-05</span>
<span class="co">#&gt;  [93,] 71  9.969e-01 5.625e-05</span>
<span class="co">#&gt;  [94,] 70  9.972e-01 5.125e-05</span>
<span class="co">#&gt;  [95,] 70  9.974e-01 4.670e-05</span>
<span class="co">#&gt;  [96,] 69  9.977e-01 4.255e-05</span>
<span class="co">#&gt;  [97,] 68  9.979e-01 3.877e-05</span>
<span class="co">#&gt;  [98,] 68  9.981e-01 3.533e-05</span>
<span class="co">#&gt;  [99,] 68  9.982e-01 3.219e-05</span>
<span class="co">#&gt; [100,] 68  9.984e-01 2.933e-05</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev    Lambda</span>
<span class="co">#&gt;   [1,]  0 -2.563e-15 2.548e-01</span>
<span class="co">#&gt;   [2,]  1  3.201e-02 2.321e-01</span>
<span class="co">#&gt;   [3,]  2  5.978e-02 2.115e-01</span>
<span class="co">#&gt;   [4,]  2  9.275e-02 1.927e-01</span>
<span class="co">#&gt;   [5,]  2  1.216e-01 1.756e-01</span>
<span class="co">#&gt;   [6,]  3  1.481e-01 1.600e-01</span>
<span class="co">#&gt;   [7,]  4  1.771e-01 1.458e-01</span>
<span class="co">#&gt;   [8,]  5  2.052e-01 1.328e-01</span>
<span class="co">#&gt;   [9,]  7  2.335e-01 1.210e-01</span>
<span class="co">#&gt;  [10,]  7  2.599e-01 1.103e-01</span>
<span class="co">#&gt;  [11,]  7  2.831e-01 1.005e-01</span>
<span class="co">#&gt;  [12,]  9  3.061e-01 9.156e-02</span>
<span class="co">#&gt;  [13,]  9  3.283e-01 8.343e-02</span>
<span class="co">#&gt;  [14,]  9  3.481e-01 7.602e-02</span>
<span class="co">#&gt;  [15,] 11  3.678e-01 6.926e-02</span>
<span class="co">#&gt;  [16,] 11  3.866e-01 6.311e-02</span>
<span class="co">#&gt;  [17,] 15  4.073e-01 5.750e-02</span>
<span class="co">#&gt;  [18,] 17  4.310e-01 5.239e-02</span>
<span class="co">#&gt;  [19,] 19  4.529e-01 4.774e-02</span>
<span class="co">#&gt;  [20,] 20  4.753e-01 4.350e-02</span>
<span class="co">#&gt;  [21,] 21  4.960e-01 3.963e-02</span>
<span class="co">#&gt;  [22,] 22  5.148e-01 3.611e-02</span>
<span class="co">#&gt;  [23,] 23  5.323e-01 3.291e-02</span>
<span class="co">#&gt;  [24,] 25  5.496e-01 2.998e-02</span>
<span class="co">#&gt;  [25,] 28  5.656e-01 2.732e-02</span>
<span class="co">#&gt;  [26,] 29  5.809e-01 2.489e-02</span>
<span class="co">#&gt;  [27,] 31  5.961e-01 2.268e-02</span>
<span class="co">#&gt;  [28,] 31  6.099e-01 2.067e-02</span>
<span class="co">#&gt;  [29,] 32  6.228e-01 1.883e-02</span>
<span class="co">#&gt;  [30,] 33  6.347e-01 1.716e-02</span>
<span class="co">#&gt;  [31,] 36  6.464e-01 1.563e-02</span>
<span class="co">#&gt;  [32,] 38  6.573e-01 1.424e-02</span>
<span class="co">#&gt;  [33,] 41  6.680e-01 1.298e-02</span>
<span class="co">#&gt;  [34,] 42  6.790e-01 1.183e-02</span>
<span class="co">#&gt;  [35,] 46  6.893e-01 1.078e-02</span>
<span class="co">#&gt;  [36,] 48  6.994e-01 9.818e-03</span>
<span class="co">#&gt;  [37,] 50  7.093e-01 8.946e-03</span>
<span class="co">#&gt;  [38,] 54  7.194e-01 8.151e-03</span>
<span class="co">#&gt;  [39,] 55  7.297e-01 7.427e-03</span>
<span class="co">#&gt;  [40,] 59  7.397e-01 6.767e-03</span>
<span class="co">#&gt;  [41,] 60  7.495e-01 6.166e-03</span>
<span class="co">#&gt;  [42,] 63  7.593e-01 5.618e-03</span>
<span class="co">#&gt;  [43,] 65  7.698e-01 5.119e-03</span>
<span class="co">#&gt;  [44,] 67  7.812e-01 4.664e-03</span>
<span class="co">#&gt;  [45,] 68  7.925e-01 4.250e-03</span>
<span class="co">#&gt;  [46,] 69  8.036e-01 3.872e-03</span>
<span class="co">#&gt;  [47,] 70  8.143e-01 3.528e-03</span>
<span class="co">#&gt;  [48,] 69  8.248e-01 3.215e-03</span>
<span class="co">#&gt;  [49,] 69  8.352e-01 2.929e-03</span>
<span class="co">#&gt;  [50,] 67  8.454e-01 2.669e-03</span>
<span class="co">#&gt;  [51,] 69  8.553e-01 2.432e-03</span>
<span class="co">#&gt;  [52,] 69  8.652e-01 2.216e-03</span>
<span class="co">#&gt;  [53,] 68  8.746e-01 2.019e-03</span>
<span class="co">#&gt;  [54,] 69  8.837e-01 1.840e-03</span>
<span class="co">#&gt;  [55,] 69  8.923e-01 1.676e-03</span>
<span class="co">#&gt;  [56,] 70  9.008e-01 1.527e-03</span>
<span class="co">#&gt;  [57,] 70  9.089e-01 1.392e-03</span>
<span class="co">#&gt;  [58,] 73  9.166e-01 1.268e-03</span>
<span class="co">#&gt;  [59,] 76  9.239e-01 1.155e-03</span>
<span class="co">#&gt;  [60,] 76  9.308e-01 1.053e-03</span>
<span class="co">#&gt;  [61,] 75  9.370e-01 9.592e-04</span>
<span class="co">#&gt;  [62,] 74  9.424e-01 8.740e-04</span>
<span class="co">#&gt;  [63,] 74  9.476e-01 7.964e-04</span>
<span class="co">#&gt;  [64,] 74  9.522e-01 7.256e-04</span>
<span class="co">#&gt;  [65,] 74  9.565e-01 6.611e-04</span>
<span class="co">#&gt;  [66,] 73  9.603e-01 6.024e-04</span>
<span class="co">#&gt;  [67,] 73  9.638e-01 5.489e-04</span>
<span class="co">#&gt;  [68,] 73  9.670e-01 5.001e-04</span>
<span class="co">#&gt;  [69,] 74  9.699e-01 4.557e-04</span>
<span class="co">#&gt;  [70,] 74  9.727e-01 4.152e-04</span>
<span class="co">#&gt;  [71,] 74  9.751e-01 3.783e-04</span>
<span class="co">#&gt;  [72,] 74  9.774e-01 3.447e-04</span>
<span class="co">#&gt;  [73,] 74  9.794e-01 3.141e-04</span>
<span class="co">#&gt;  [74,] 73  9.813e-01 2.862e-04</span>
<span class="co">#&gt;  [75,] 74  9.829e-01 2.608e-04</span>
<span class="co">#&gt;  [76,] 74  9.845e-01 2.376e-04</span>
<span class="co">#&gt;  [77,] 74  9.859e-01 2.165e-04</span>
<span class="co">#&gt;  [78,] 74  9.871e-01 1.973e-04</span>
<span class="co">#&gt;  [79,] 74  9.883e-01 1.797e-04</span>
<span class="co">#&gt;  [80,] 74  9.893e-01 1.638e-04</span>
<span class="co">#&gt;  [81,] 74  9.903e-01 1.492e-04</span>
<span class="co">#&gt;  [82,] 74  9.911e-01 1.360e-04</span>
<span class="co">#&gt;  [83,] 74  9.919e-01 1.239e-04</span>
<span class="co">#&gt;  [84,] 74  9.926e-01 1.129e-04</span>
<span class="co">#&gt;  [85,] 74  9.933e-01 1.029e-04</span>
<span class="co">#&gt;  [86,] 74  9.939e-01 9.372e-05</span>
<span class="co">#&gt;  [87,] 74  9.944e-01 8.539e-05</span>
<span class="co">#&gt;  [88,] 74  9.949e-01 7.780e-05</span>
<span class="co">#&gt;  [89,] 75  9.954e-01 7.089e-05</span>
<span class="co">#&gt;  [90,] 76  9.958e-01 6.459e-05</span>
<span class="co">#&gt;  [91,] 76  9.961e-01 5.886e-05</span>
<span class="co">#&gt;  [92,] 76  9.965e-01 5.363e-05</span>
<span class="co">#&gt;  [93,] 76  9.968e-01 4.886e-05</span>
<span class="co">#&gt;  [94,] 76  9.971e-01 4.452e-05</span>
<span class="co">#&gt;  [95,] 76  9.973e-01 4.057e-05</span>
<span class="co">#&gt;  [96,] 76  9.976e-01 3.696e-05</span>
<span class="co">#&gt;  [97,] 76  9.978e-01 3.368e-05</span>
<span class="co">#&gt;  [98,] 76  9.980e-01 3.069e-05</span>
<span class="co">#&gt;  [99,] 76  9.981e-01 2.796e-05</span>
<span class="co">#&gt; [100,] 76  9.983e-01 2.548e-05</span>
<span class="co">#&gt; [1] "done bootstrap 2"</span>

<span class="co"># display the list of result information in the LASOLDA_dat object </span>
<span class="kw">names</span>(LSOLDA_dat)
<span class="co">#&gt; [1] "Accuracy"     "LassoGenes"   "Deviance"     "LassoFit"    </span>
<span class="co">#&gt; [5] "LDAFit"       "predictor_S1" "LassoPredict" "LDAPredict"</span>
LSOLDA_dat<span class="op">$</span>LassoPredict
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt; [1] "LASSO for subpop1 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt; [1] 98.93048</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[3]]</span>
<span class="co">#&gt; [1] "LASSO for subpop2 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[4]]</span>
<span class="co">#&gt; [1] 96.42857</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[5]]</span>
<span class="co">#&gt; [1] "LASSO for subpop3 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[6]]</span>
<span class="co">#&gt; [1] 93.98496</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[7]]</span>
<span class="co">#&gt; [1] "LASSO for subpop4 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[8]]</span>
<span class="co">#&gt; [1] 97.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]][[1]]</span>
<span class="co">#&gt; [1] "LASSO for subpop1 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[2]]</span>
<span class="co">#&gt; [1] 94.65241</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[3]]</span>
<span class="co">#&gt; [1] "LASSO for subpop2 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[4]]</span>
<span class="co">#&gt; [1] 97.85714</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[5]]</span>
<span class="co">#&gt; [1] "LASSO for subpop3 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[6]]</span>
<span class="co">#&gt; [1] 86.46617</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[7]]</span>
<span class="co">#&gt; [1] "LASSO for subpop4 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[8]]</span>
<span class="co">#&gt; [1] 95</span>
LSOLDA_dat<span class="op">$</span>LDAPredict
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]][[1]]</span>
<span class="co">#&gt; [1] "LDA for subpop 1 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[2]]</span>
<span class="co">#&gt; [1] 94.65241</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[3]]</span>
<span class="co">#&gt; [1] "LDA for subpop 2 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[4]]</span>
<span class="co">#&gt; [1] 90</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[5]]</span>
<span class="co">#&gt; [1] "LDA for subpop 3 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[6]]</span>
<span class="co">#&gt; [1] 81.20301</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[7]]</span>
<span class="co">#&gt; [1] "LDA for subpop 4 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]][[8]]</span>
<span class="co">#&gt; [1] 95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]][[1]]</span>
<span class="co">#&gt; [1] "LDA for subpop 1 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[2]]</span>
<span class="co">#&gt; [1] 9.625668</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[3]]</span>
<span class="co">#&gt; [1] "LDA for subpop 2 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[4]]</span>
<span class="co">#&gt; [1] 56.42857</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[5]]</span>
<span class="co">#&gt; [1] "LDA for subpop 3 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[6]]</span>
<span class="co">#&gt; [1] 4.511278</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[7]]</span>
<span class="co">#&gt; [1] "LDA for subpop 4 in target mixedpop2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]][[8]]</span>
<span class="co">#&gt; [1] 22.5</span>

<span class="co"># summary results LDA</span>
<span class="kw"><a href="../reference/summary_prediction_lda.html">summary_prediction_lda</a></span>(<span class="dt">LSOLDA_dat =</span> LSOLDA_dat, <span class="dt">nPredSubpop =</span> <span class="dv">4</span>)
<span class="co">#&gt;                 V1               V2                                names</span>
<span class="co">#&gt; 1 94.6524064171123 9.62566844919786 LDA for subpop 1 in target mixedpop2</span>
<span class="co">#&gt; 2               90 56.4285714285714 LDA for subpop 2 in target mixedpop2</span>
<span class="co">#&gt; 3  81.203007518797 4.51127819548872 LDA for subpop 3 in target mixedpop2</span>
<span class="co">#&gt; 4               95             22.5 LDA for subpop 4 in target mixedpop2</span>

<span class="co"># summary results Lasso</span>
<span class="kw"><a href="../reference/summary_prediction_lasso.html">summary_prediction_lasso</a></span>(<span class="dt">LSOLDA_dat =</span> LSOLDA_dat, <span class="dt">nPredSubpop =</span> <span class="dv">4</span>)
<span class="co">#&gt;                 V1               V2                                 names</span>
<span class="co">#&gt; 1 98.9304812834225 94.6524064171123 LASSO for subpop1 in target mixedpop2</span>
<span class="co">#&gt; 2 96.4285714285714 97.8571428571428 LASSO for subpop2 in target mixedpop2</span>
<span class="co">#&gt; 3  93.984962406015 86.4661654135338 LASSO for subpop3 in target mixedpop2</span>
<span class="co">#&gt; 4             97.5               95 LASSO for subpop4 in target mixedpop2</span>

<span class="co"># summary deviance</span>
<span class="kw"><a href="../reference/summary_deviance.html">summary_deviance</a></span>(<span class="dt">object =</span> LSOLDA_dat)
<span class="co">#&gt; $allDeviance</span>
<span class="co">#&gt; [1] "0.427"  "0.3678"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DeviMax</span>
<span class="co">#&gt;          Dfd   Deviance        DEgenes</span>
<span class="co">#&gt; 1          0 -2.563e-15 genes_cluster1</span>
<span class="co">#&gt; 2          1      0.136 genes_cluster1</span>
<span class="co">#&gt; 3          2     0.1658 genes_cluster1</span>
<span class="co">#&gt; 4          3      0.221 genes_cluster1</span>
<span class="co">#&gt; 5          4     0.2699 genes_cluster1</span>
<span class="co">#&gt; 6          5     0.3142 genes_cluster1</span>
<span class="co">#&gt; 7          7     0.3547 genes_cluster1</span>
<span class="co">#&gt; 8          8     0.3739 genes_cluster1</span>
<span class="co">#&gt; 9          9     0.3926 genes_cluster1</span>
<span class="co">#&gt; 10        10     0.4103 genes_cluster1</span>
<span class="co">#&gt; 11        12      0.427 genes_cluster1</span>
<span class="co">#&gt; 12 remaining          1        DEgenes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LassoGenesMax</span>
<span class="co">#&gt;                                   1                  name</span>
<span class="co">#&gt; (Intercept)            0.2050680819           (Intercept)</span>
<span class="co">#&gt; FN1_ENSG00000115414   -0.0306737545   FN1_ENSG00000115414</span>
<span class="co">#&gt; MSX1_ENSG00000163132   0.0065297632  MSX1_ENSG00000163132</span>
<span class="co">#&gt; PRDM1_ENSG00000057657 -0.0004696923 PRDM1_ENSG00000057657</span>
<span class="co">#&gt; T_ENSG00000164458      0.2265405283     T_ENSG00000164458</span>
<span class="co">#&gt; SOX17_ENSG00000164736 -0.0569230075 SOX17_ENSG00000164736</span>
<span class="co">#&gt; TPM1_ENSG00000140416  -0.0860388071  TPM1_ENSG00000140416</span>
<span class="co">#&gt; MESP1_ENSG00000166823  0.0223208045 MESP1_ENSG00000166823</span>
<span class="co">#&gt; MESP2_ENSG00000188095  0.0942978476 MESP2_ENSG00000188095</span>
<span class="co">#&gt; FOXF1_ENSG00000103241  0.1159350563 FOXF1_ENSG00000103241</span>
<span class="co">#&gt; HNF1B_ENSG00000275410 -0.0380615440 HNF1B_ENSG00000275410</span>
<span class="co">#&gt; FOXA2_ENSG00000125798 -0.0636808921 FOXA2_ENSG00000125798</span>
<span class="co">#&gt; SNAI1_ENSG00000124216  0.3124858215 SNAI1_ENSG00000124216</span></code></pre></div>
</div>
</div>
<div id="a-complete-workflow-of-the-scgps" class="section level1">
<h1 class="hasAnchor">
<a href="#a-complete-workflow-of-the-scgps" class="anchor"></a>3. A complete workflow of the scGPS:</h1>
<p><em>The purpose of this workflow is to solve the following task: given an unknown mixed population, find clusters and estimate relationship between clusters</em></p>
<div id="identify-clusters-in-a-using-core" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-clusters-in-a-using-core" class="anchor"></a>3.1 Identify clusters in a using CORE</h2>
<p><em>(skip this step if clusters are known)</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#Let's find clustering information in an expresion data</span>
day5 &lt;-<span class="st"> </span>sample2
cellnames &lt;-<span class="st"> </span><span class="kw">colnames</span>(day5<span class="op">$</span>dat5_counts)
cluster &lt;-day5<span class="op">$</span>dat5_clusters
cellnames &lt;-<span class="kw">data.frame</span>(<span class="st">"Cluster"</span>=cluster, <span class="st">"cellBarcodes"</span> =<span class="st"> </span>cellnames)
mixedpop2 &lt;-<span class="kw"><a href="../reference/NewscGPS_SME.html">NewscGPS_SME</a></span>(<span class="dt">ExpressionMatrix =</span> day5<span class="op">$</span>dat5_counts, <span class="dt">GeneMetadata =</span> day5<span class="op">$</span>dat5geneInfo, <span class="dt">CellMetadata =</span> cellnames ) 

CORE_cluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CORE_scGPS.html">CORE_scGPS</a></span>(mixedpop2, <span class="dt">remove_outlier =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">PCA=</span><span class="ot">FALSE</span>)
<span class="co">#&gt; [1] "Identifying top variable genes"</span>
<span class="co">#&gt; [1] "Calculating distance matrix"</span>
<span class="co">#&gt; [1] "Performing hierarchical clustering"</span>
<span class="co">#&gt; [1] "Finding clustering information"</span>
<span class="co">#&gt; [1] "No more outliers detected after 1 filtering round"</span>
<span class="co">#&gt; [1] "writing clustering result for run 1"</span>
<span class="co">#&gt; [1] "writing clustering result for run 2"</span>
<span class="co">#&gt; [1] "writing clustering result for run 3"</span>
<span class="co">#&gt; [1] "writing clustering result for run 4"</span>
<span class="co">#&gt; [1] "writing clustering result for run 5"</span>
<span class="co">#&gt; [1] "writing clustering result for run 6"</span>
<span class="co">#&gt; [1] "writing clustering result for run 7"</span>
<span class="co">#&gt; [1] "writing clustering result for run 8"</span>
<span class="co">#&gt; [1] "writing clustering result for run 9"</span>
<span class="co">#&gt; [1] "writing clustering result for run 10"</span>
<span class="co">#&gt; [1] "writing clustering result for run 11"</span>
<span class="co">#&gt; [1] "writing clustering result for run 12"</span>
<span class="co">#&gt; [1] "writing clustering result for run 13"</span>
<span class="co">#&gt; [1] "writing clustering result for run 14"</span>
<span class="co">#&gt; [1] "writing clustering result for run 15"</span>
<span class="co">#&gt; [1] "writing clustering result for run 16"</span>
<span class="co">#&gt; [1] "writing clustering result for run 17"</span>
<span class="co">#&gt; [1] "writing clustering result for run 18"</span>
<span class="co">#&gt; [1] "writing clustering result for run 19"</span>
<span class="co">#&gt; [1] "writing clustering result for run 20"</span>
<span class="co">#&gt; [1] "writing clustering result for run 21"</span>
<span class="co">#&gt; [1] "writing clustering result for run 22"</span>
<span class="co">#&gt; [1] "writing clustering result for run 23"</span>
<span class="co">#&gt; [1] "writing clustering result for run 24"</span>
<span class="co">#&gt; [1] "writing clustering result for run 25"</span>
<span class="co">#&gt; [1] "writing clustering result for run 26"</span>
<span class="co">#&gt; [1] "writing clustering result for run 27"</span>
<span class="co">#&gt; [1] "writing clustering result for run 28"</span>
<span class="co">#&gt; [1] "writing clustering result for run 29"</span>
<span class="co">#&gt; [1] "writing clustering result for run 30"</span>
<span class="co">#&gt; [1] "writing clustering result for run 31"</span>
<span class="co">#&gt; [1] "writing clustering result for run 32"</span>
<span class="co">#&gt; [1] "writing clustering result for run 33"</span>
<span class="co">#&gt; [1] "writing clustering result for run 34"</span>
<span class="co">#&gt; [1] "writing clustering result for run 35"</span>
<span class="co">#&gt; [1] "writing clustering result for run 36"</span>
<span class="co">#&gt; [1] "writing clustering result for run 37"</span>
<span class="co">#&gt; [1] "writing clustering result for run 38"</span>
<span class="co">#&gt; [1] "writing clustering result for run 39"</span>
<span class="co">#&gt; [1] "writing clustering result for run 40"</span>
<span class="co">#&gt; [1] "Done clustering, moving to stability calculation..."</span>
<span class="co">#&gt; [1] "Done calculating stability..."</span>
<span class="co">#&gt; [1] "Start finding optimal clustering..."</span>
<span class="co">#&gt; [1] "Done finding optimal clustering..."</span></code></pre></div>
</div>
<div id="visualise-all-cluster-results-in-all-iterations" class="section level2">
<h2 class="hasAnchor">
<a href="#visualise-all-cluster-results-in-all-iterations" class="anchor"></a>3.2 Visualise all cluster results in all iterations</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot with default colors</span>
<span class="kw"><a href="../reference/plot_CORE.html">plot_CORE</a></span>(CORE_cluster<span class="op">$</span>tree, CORE_cluster<span class="op">$</span>Cluster)</code></pre></div>
<p><img src="man/figures/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#let's find the CORE clusters</span>
CORE_cluster &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CORE_scGPS.html">CORE_scGPS</a></span>(mixedpop2, <span class="dt">remove_outlier =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">PCA=</span><span class="ot">FALSE</span>)
<span class="co">#&gt; [1] "Identifying top variable genes"</span>
<span class="co">#&gt; [1] "Calculating distance matrix"</span>
<span class="co">#&gt; [1] "Performing hierarchical clustering"</span>
<span class="co">#&gt; [1] "Finding clustering information"</span>
<span class="co">#&gt; [1] "No more outliers detected after 1 filtering round"</span>
<span class="co">#&gt; [1] "writing clustering result for run 1"</span>
<span class="co">#&gt; [1] "writing clustering result for run 2"</span>
<span class="co">#&gt; [1] "writing clustering result for run 3"</span>
<span class="co">#&gt; [1] "writing clustering result for run 4"</span>
<span class="co">#&gt; [1] "writing clustering result for run 5"</span>
<span class="co">#&gt; [1] "writing clustering result for run 6"</span>
<span class="co">#&gt; [1] "writing clustering result for run 7"</span>
<span class="co">#&gt; [1] "writing clustering result for run 8"</span>
<span class="co">#&gt; [1] "writing clustering result for run 9"</span>
<span class="co">#&gt; [1] "writing clustering result for run 10"</span>
<span class="co">#&gt; [1] "writing clustering result for run 11"</span>
<span class="co">#&gt; [1] "writing clustering result for run 12"</span>
<span class="co">#&gt; [1] "writing clustering result for run 13"</span>
<span class="co">#&gt; [1] "writing clustering result for run 14"</span>
<span class="co">#&gt; [1] "writing clustering result for run 15"</span>
<span class="co">#&gt; [1] "writing clustering result for run 16"</span>
<span class="co">#&gt; [1] "writing clustering result for run 17"</span>
<span class="co">#&gt; [1] "writing clustering result for run 18"</span>
<span class="co">#&gt; [1] "writing clustering result for run 19"</span>
<span class="co">#&gt; [1] "writing clustering result for run 20"</span>
<span class="co">#&gt; [1] "writing clustering result for run 21"</span>
<span class="co">#&gt; [1] "writing clustering result for run 22"</span>
<span class="co">#&gt; [1] "writing clustering result for run 23"</span>
<span class="co">#&gt; [1] "writing clustering result for run 24"</span>
<span class="co">#&gt; [1] "writing clustering result for run 25"</span>
<span class="co">#&gt; [1] "writing clustering result for run 26"</span>
<span class="co">#&gt; [1] "writing clustering result for run 27"</span>
<span class="co">#&gt; [1] "writing clustering result for run 28"</span>
<span class="co">#&gt; [1] "writing clustering result for run 29"</span>
<span class="co">#&gt; [1] "writing clustering result for run 30"</span>
<span class="co">#&gt; [1] "writing clustering result for run 31"</span>
<span class="co">#&gt; [1] "writing clustering result for run 32"</span>
<span class="co">#&gt; [1] "writing clustering result for run 33"</span>
<span class="co">#&gt; [1] "writing clustering result for run 34"</span>
<span class="co">#&gt; [1] "writing clustering result for run 35"</span>
<span class="co">#&gt; [1] "writing clustering result for run 36"</span>
<span class="co">#&gt; [1] "writing clustering result for run 37"</span>
<span class="co">#&gt; [1] "writing clustering result for run 38"</span>
<span class="co">#&gt; [1] "writing clustering result for run 39"</span>
<span class="co">#&gt; [1] "writing clustering result for run 40"</span>
<span class="co">#&gt; [1] "Done clustering, moving to stability calculation..."</span>
<span class="co">#&gt; [1] "Done calculating stability..."</span>
<span class="co">#&gt; [1] "Start finding optimal clustering..."</span>
<span class="co">#&gt; [1] "Done finding optimal clustering..."</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#let's plot all clusters</span>
<span class="kw"><a href="../reference/plot_CORE.html">plot_CORE</a></span>(CORE_cluster<span class="op">$</span>tree, CORE_cluster<span class="op">$</span>Cluster)</code></pre></div>
<p><img src="man/figures/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#you can customise the cluster color bars (provide color_branch values)</span>
<span class="kw"><a href="../reference/plot_CORE.html">plot_CORE</a></span>(CORE_cluster<span class="op">$</span>tree, CORE_cluster<span class="op">$</span>Cluster, <span class="dt">color_branch =</span> <span class="kw">c</span>(<span class="st">"#208eb7"</span>, <span class="st">"#6ce9d3"</span>, <span class="st">"#1c5e39"</span>, <span class="st">"#8fca40"</span>, <span class="st">"#154975"</span>, <span class="st">"#b1c8eb"</span>))</code></pre></div>
<p><img src="man/figures/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#you can customise the cluster color bars (provide color_branch values)</span>
<span class="kw"><a href="../reference/plot_CORE.html">plot_CORE</a></span>(CORE_cluster<span class="op">$</span>tree, CORE_cluster<span class="op">$</span>Cluster, <span class="dt">color_branch =</span> <span class="kw">c</span>(<span class="st">"#208eb7"</span>, <span class="st">"#6ce9d3"</span>, <span class="st">"#1c5e39"</span>, <span class="st">"#8fca40"</span>, <span class="st">"#154975"</span>, <span class="st">"#b1c8eb"</span>))</code></pre></div>
<p><img src="man/figures/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="plot-the-optimal-clustering-result" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-optimal-clustering-result" class="anchor"></a>3.3 Plot the optimal clustering result</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#extract optimal index identified by CORE_scGPS</span>
optimal_index =<span class="st"> </span><span class="kw">which</span>(CORE_cluster<span class="op">$</span>optimalClust<span class="op">$</span>KeyStats<span class="op">$</span>Height <span class="op">==</span><span class="st"> </span>CORE_cluster<span class="op">$</span>optimalClust<span class="op">$</span>OptimalRes)

<span class="co">#plot the optimal result</span>
<span class="kw"><a href="../reference/plot_optimal_CORE.html">plot_optimal_CORE</a></span>(<span class="dt">original_tree=</span> CORE_cluster<span class="op">$</span>tree, <span class="dt">optimal_cluster =</span> <span class="kw">unlist</span>(CORE_cluster<span class="op">$</span>Cluster[optimal_index]), <span class="dt">shift =</span> <span class="op">-</span><span class="dv">100</span>)
<span class="co">#&gt; [1] "Ordering and assigning labels..."</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; [1] 128 270  NA</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; [1] 128 270 393</span>
<span class="co">#&gt; [1] "Plotting the colored dendrogram now...."</span></code></pre></div>
<p><img src="man/figures/unnamed-chunk-10-1.png" width="700"></p>
<pre><code>#&gt; [1] "Plotting the bar underneath now...."</code></pre>
</div>
<div id="compare-clustering-results-with-other-dimensional-reduction-methods-e-g--cidr" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-clustering-results-with-other-dimensional-reduction-methods-e-g--cidr" class="anchor"></a>3.4 Compare clustering results with other dimensional reduction methods (e.g., CIDR)</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cidr)
t &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CIDR_scGPS.html">CIDR_scGPS</a></span>(<span class="dt">expression.matrix=</span><span class="kw">assay</span>(mixedpop2))
<span class="co">#&gt; [1] "building cidr object..."</span>
<span class="co">#&gt; [1] "determine dropout candidates..."</span>
<span class="co">#&gt; [1] "determine the imputation weighting threshold..."</span>
<span class="co">#&gt; [1] "computes the _CIDR_ dissimilarity matrix..."</span>
<span class="co">#&gt; [1] "PCA plot with proportion of variance explained..."</span></code></pre></div>
<p><img src="man/figures/unnamed-chunk-11-1.png" width="700"></p>
<pre><code>#&gt; [1] "find the number of PC..."
#&gt; [1] "perform clustering..."
p2 &lt;-plotReduced_scGPS(t, color_fac = factor(colData(mixedpop2)[,1]),palletes =1:length(unique(colData(mixedpop2)[,1])))
#&gt; Warning: package 'cowplot' was built under R version 3.4.3
#&gt; 
#&gt; Attaching package: 'cowplot'
#&gt; The following object is masked from 'package:ggplot2':
#&gt; 
#&gt;     ggsave
p2</code></pre>
<p><img src="man/figures/unnamed-chunk-11-2.png" width="700"></p>
</div>
<div id="find-gene-markers-and-annotate-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#find-gene-markers-and-annotate-clusters" class="anchor"></a>3.5 Find gene markers and annotate clusters</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#load gene list (this can be any lists of user-selected genes)</span>
genes &lt;-GeneList
genes &lt;-genes<span class="op">$</span>Merged_unique

<span class="co">#the gene list can also be objectively identified by differential expression analysis</span>
<span class="co">#cluster information is requied for findMarkers_scGPS. Here, we use CORE results. </span>

Optimal_index &lt;-<span class="st"> </span><span class="kw">which</span>( CORE_cluster<span class="op">$</span>optimalClust<span class="op">$</span>KeyStats<span class="op">$</span>Height <span class="op">==</span><span class="st"> </span>CORE_cluster<span class="op">$</span>optimalClust<span class="op">$</span>OptimalRes)
<span class="kw">colData</span>(mixedpop2)[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">unlist</span>(CORE_cluster<span class="op">$</span>Cluster[[Optimal_index]])

<span class="kw">suppressMessages</span>(<span class="kw">library</span>(locfit))
<span class="kw">suppressMessages</span>(<span class="kw">library</span>(DESeq))

DEgenes &lt;-<span class="st"> </span><span class="kw"><a href="../reference/findMarkers_scGPS.html">findMarkers_scGPS</a></span>(<span class="dt">expression_matrix=</span><span class="kw">assay</span>(mixedpop2), <span class="dt">cluster =</span> <span class="kw">colData</span>(mixedpop2)[,<span class="dv">1</span>],
                             <span class="dt">selected_cluster=</span><span class="kw">unique</span>(<span class="kw">colData</span>(mixedpop2)[,<span class="dv">1</span>]))
<span class="co">#&gt; [1] "Start estimate dispersions for cluster 1..."</span>
<span class="co">#&gt; [1] "Done estimate dispersions. Start nbinom test for cluster 1..."</span>
<span class="co">#&gt; [1] "Done nbinom test for cluster 1 ..."</span>
<span class="co">#&gt; [1] "Adjust foldchange by subtracting basemean to 1..."</span>
<span class="co">#&gt; [1] "Start estimate dispersions for cluster 2..."</span>
<span class="co">#&gt; [1] "Done estimate dispersions. Start nbinom test for cluster 2..."</span>
<span class="co">#&gt; [1] "Done nbinom test for cluster 2 ..."</span>
<span class="co">#&gt; [1] "Adjust foldchange by subtracting basemean to 1..."</span>
<span class="co">#&gt; [1] "Start estimate dispersions for cluster 3..."</span>
<span class="co">#&gt; [1] "Done estimate dispersions. Start nbinom test for cluster 3..."</span>
<span class="co">#&gt; [1] "Done nbinom test for cluster 3 ..."</span>
<span class="co">#&gt; [1] "Adjust foldchange by subtracting basemean to 1..."</span>

<span class="co">#the output contains dataframes for each cluster.</span>
<span class="co">#the data frame contains all genes, sorted by p-values </span>
<span class="kw">names</span>(DEgenes)
<span class="co">#&gt; [1] "DE_Subpop1vsRemaining" "DE_Subpop2vsRemaining" "DE_Subpop3vsRemaining"</span>

<span class="co">#you can annotate the identified clusters </span>
DEgeneList_3vsOthers &lt;-<span class="st"> </span>DEgenes<span class="op">$</span>DE_Subpop3vsRemaining<span class="op">$</span>id

<span class="co">#users need to check the format of the gene input to make sure they are consistent to </span>
<span class="co">#the gene names in the expression matrix </span>
DEgeneList_3vsOthers &lt;-<span class="kw">gsub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, DEgeneList_3vsOthers )

<span class="co">#the following command saves the file "PathwayEnrichment.xlsx" to the working dir</span>
<span class="co">#use 500 top DE genes </span>
<span class="kw">suppressMessages</span>(<span class="kw">library</span>(DOSE))
<span class="kw">suppressMessages</span>(<span class="kw">library</span>(ReactomePA))
<span class="kw">suppressMessages</span>(<span class="kw">library</span>(clusterProfiler))

enrichment_test &lt;-<span class="st"> </span><span class="kw"><a href="../reference/annotate_scGPS.html">annotate_scGPS</a></span>(DEgeneList_3vsOthers[<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>], <span class="dt">pvalueCutoff=</span><span class="fl">0.05</span>, <span class="dt">gene_symbol=</span><span class="ot">TRUE</span>,<span class="dt">output_filename =</span> <span class="st">"PathwayEnrichment.xlsx"</span>, <span class="dt">output_path =</span> <span class="ot">NULL</span> )
<span class="co">#&gt; [1] "Original gene number in geneList"</span>
<span class="co">#&gt; [1] 500</span>
<span class="co">#&gt; [1] "Number of genes successfully converted"</span>
<span class="co">#&gt; [1] 490</span>

<span class="co">#the enrichment outputs can be displayed by running</span>
<span class="kw"><a href="http://www.rdocumentation.org/packages/DOSE/topics/dotplot-methods">dotplot</a></span>(enrichment_test, <span class="dt">showCategory=</span><span class="dv">15</span>)</code></pre></div>
<p><img src="man/figures/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div id="relationship-between-clusters-within-one-sample-or-between-two-samples" class="section level1">
<h1 class="hasAnchor">
<a href="#relationship-between-clusters-within-one-sample-or-between-two-samples" class="anchor"></a>4. Relationship between clusters within one sample or between two samples</h1>
<p><em>The purpose of this workflow is to solve the following task: given one or two unknown mixed population(s) and clusters in each mixed population, estimate and visualise relationship between clusters</em></p>
<div id="start-the-scgps-prediction-to-find-relationship-between-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#start-the-scgps-prediction-to-find-relationship-between-clusters" class="anchor"></a>4.1 Start the scGPS prediction to find relationship between clusters</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#select a subpopulation, and input gene list </span>
c_selectID &lt;-<span class="st"> </span><span class="dv">1</span>
genes =<span class="st"> </span>DEgenes<span class="op">$</span>DE_Subpop1vsRemaining<span class="op">$</span>id[<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>]
<span class="co">#format gene names </span>
genes &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, genes)

<span class="co">#run the test bootstrap with nboots = 2 runs</span>
<span class="kw">sink</span>(<span class="st">"temp"</span>)
LSOLDA_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">2</span>,<span class="dt">mixedpop1 =</span> mixedpop2, <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes=</span>genes, c_selectID, <span class="dt">listData =</span><span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev   Lambda</span>
<span class="co">#&gt;   [1,]  0 -1.922e-15 0.354500</span>
<span class="co">#&gt;   [2,]  1  3.234e-02 0.338400</span>
<span class="co">#&gt;   [3,]  1  6.251e-02 0.323000</span>
<span class="co">#&gt;   [4,]  1  9.119e-02 0.308300</span>
<span class="co">#&gt;   [5,]  1  1.188e-01 0.294300</span>
<span class="co">#&gt;   [6,]  1  1.456e-01 0.280900</span>
<span class="co">#&gt;   [7,]  1  1.716e-01 0.268100</span>
<span class="co">#&gt;   [8,]  1  1.969e-01 0.256000</span>
<span class="co">#&gt;   [9,]  1  2.215e-01 0.244300</span>
<span class="co">#&gt;  [10,]  1  2.454e-01 0.233200</span>
<span class="co">#&gt;  [11,]  1  2.686e-01 0.222600</span>
<span class="co">#&gt;  [12,]  1  2.910e-01 0.212500</span>
<span class="co">#&gt;  [13,]  1  3.127e-01 0.202800</span>
<span class="co">#&gt;  [14,]  1  3.337e-01 0.193600</span>
<span class="co">#&gt;  [15,]  1  3.540e-01 0.184800</span>
<span class="co">#&gt;  [16,]  1  3.735e-01 0.176400</span>
<span class="co">#&gt;  [17,]  1  3.924e-01 0.168400</span>
<span class="co">#&gt;  [18,]  1  4.106e-01 0.160800</span>
<span class="co">#&gt;  [19,]  1  4.282e-01 0.153400</span>
<span class="co">#&gt;  [20,]  1  4.451e-01 0.146500</span>
<span class="co">#&gt;  [21,]  1  4.614e-01 0.139800</span>
<span class="co">#&gt;  [22,]  1  4.771e-01 0.133500</span>
<span class="co">#&gt;  [23,]  1  4.922e-01 0.127400</span>
<span class="co">#&gt;  [24,]  1  5.068e-01 0.121600</span>
<span class="co">#&gt;  [25,]  1  5.209e-01 0.116100</span>
<span class="co">#&gt;  [26,]  1  5.344e-01 0.110800</span>
<span class="co">#&gt;  [27,]  1  5.474e-01 0.105800</span>
<span class="co">#&gt;  [28,]  1  5.599e-01 0.101000</span>
<span class="co">#&gt;  [29,]  1  5.719e-01 0.096370</span>
<span class="co">#&gt;  [30,]  2  5.840e-01 0.091990</span>
<span class="co">#&gt;  [31,]  5  5.958e-01 0.087810</span>
<span class="co">#&gt;  [32,]  5  6.075e-01 0.083820</span>
<span class="co">#&gt;  [33,]  5  6.187e-01 0.080010</span>
<span class="co">#&gt;  [34,]  5  6.294e-01 0.076370</span>
<span class="co">#&gt;  [35,]  5  6.397e-01 0.072900</span>
<span class="co">#&gt;  [36,]  5  6.496e-01 0.069590</span>
<span class="co">#&gt;  [37,]  5  6.591e-01 0.066420</span>
<span class="co">#&gt;  [38,]  5  6.682e-01 0.063400</span>
<span class="co">#&gt;  [39,]  6  6.770e-01 0.060520</span>
<span class="co">#&gt;  [40,]  6  6.854e-01 0.057770</span>
<span class="co">#&gt;  [41,]  6  6.936e-01 0.055150</span>
<span class="co">#&gt;  [42,]  9  7.018e-01 0.052640</span>
<span class="co">#&gt;  [43,]  9  7.099e-01 0.050250</span>
<span class="co">#&gt;  [44,]  9  7.176e-01 0.047960</span>
<span class="co">#&gt;  [45,]  9  7.250e-01 0.045780</span>
<span class="co">#&gt;  [46,] 10  7.323e-01 0.043700</span>
<span class="co">#&gt;  [47,] 10  7.393e-01 0.041720</span>
<span class="co">#&gt;  [48,] 10  7.461e-01 0.039820</span>
<span class="co">#&gt;  [49,] 10  7.526e-01 0.038010</span>
<span class="co">#&gt;  [50,] 12  7.592e-01 0.036280</span>
<span class="co">#&gt;  [51,] 12  7.657e-01 0.034630</span>
<span class="co">#&gt;  [52,] 13  7.721e-01 0.033060</span>
<span class="co">#&gt;  [53,] 13  7.784e-01 0.031560</span>
<span class="co">#&gt;  [54,] 13  7.845e-01 0.030120</span>
<span class="co">#&gt;  [55,] 13  7.904e-01 0.028750</span>
<span class="co">#&gt;  [56,] 16  7.961e-01 0.027450</span>
<span class="co">#&gt;  [57,] 18  8.017e-01 0.026200</span>
<span class="co">#&gt;  [58,] 19  8.073e-01 0.025010</span>
<span class="co">#&gt;  [59,] 20  8.128e-01 0.023870</span>
<span class="co">#&gt;  [60,] 24  8.184e-01 0.022790</span>
<span class="co">#&gt;  [61,] 24  8.244e-01 0.021750</span>
<span class="co">#&gt;  [62,] 26  8.304e-01 0.020760</span>
<span class="co">#&gt;  [63,] 25  8.361e-01 0.019820</span>
<span class="co">#&gt;  [64,] 25  8.416e-01 0.018920</span>
<span class="co">#&gt;  [65,] 26  8.469e-01 0.018060</span>
<span class="co">#&gt;  [66,] 28  8.522e-01 0.017240</span>
<span class="co">#&gt;  [67,] 28  8.576e-01 0.016450</span>
<span class="co">#&gt;  [68,] 28  8.627e-01 0.015710</span>
<span class="co">#&gt;  [69,] 32  8.680e-01 0.014990</span>
<span class="co">#&gt;  [70,] 33  8.732e-01 0.014310</span>
<span class="co">#&gt;  [71,] 36  8.784e-01 0.013660</span>
<span class="co">#&gt;  [72,] 37  8.834e-01 0.013040</span>
<span class="co">#&gt;  [73,] 37  8.883e-01 0.012450</span>
<span class="co">#&gt;  [74,] 37  8.929e-01 0.011880</span>
<span class="co">#&gt;  [75,] 40  8.974e-01 0.011340</span>
<span class="co">#&gt;  [76,] 41  9.018e-01 0.010830</span>
<span class="co">#&gt;  [77,] 43  9.059e-01 0.010330</span>
<span class="co">#&gt;  [78,] 43  9.099e-01 0.009864</span>
<span class="co">#&gt;  [79,] 43  9.138e-01 0.009415</span>
<span class="co">#&gt;  [80,] 45  9.175e-01 0.008987</span>
<span class="co">#&gt;  [81,] 45  9.211e-01 0.008579</span>
<span class="co">#&gt;  [82,] 47  9.246e-01 0.008189</span>
<span class="co">#&gt;  [83,] 46  9.280e-01 0.007817</span>
<span class="co">#&gt;  [84,] 46  9.312e-01 0.007461</span>
<span class="co">#&gt;  [85,] 46  9.343e-01 0.007122</span>
<span class="co">#&gt;  [86,] 47  9.372e-01 0.006799</span>
<span class="co">#&gt;  [87,] 47  9.400e-01 0.006490</span>
<span class="co">#&gt;  [88,] 48  9.427e-01 0.006195</span>
<span class="co">#&gt;  [89,] 49  9.453e-01 0.005913</span>
<span class="co">#&gt;  [90,] 50  9.477e-01 0.005644</span>
<span class="co">#&gt;  [91,] 51  9.501e-01 0.005388</span>
<span class="co">#&gt;  [92,] 52  9.523e-01 0.005143</span>
<span class="co">#&gt;  [93,] 52  9.545e-01 0.004909</span>
<span class="co">#&gt;  [94,] 52  9.566e-01 0.004686</span>
<span class="co">#&gt;  [95,] 54  9.585e-01 0.004473</span>
<span class="co">#&gt;  [96,] 54  9.604e-01 0.004270</span>
<span class="co">#&gt;  [97,] 54  9.622e-01 0.004076</span>
<span class="co">#&gt;  [98,] 54  9.639e-01 0.003890</span>
<span class="co">#&gt;  [99,] 54  9.656e-01 0.003714</span>
<span class="co">#&gt; [100,] 55  9.671e-01 0.003545</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df       %Dev   Lambda</span>
<span class="co">#&gt;   [1,]  0 -1.922e-15 0.370700</span>
<span class="co">#&gt;   [2,]  1  3.529e-02 0.353900</span>
<span class="co">#&gt;   [3,]  1  6.777e-02 0.337800</span>
<span class="co">#&gt;   [4,]  1  9.792e-02 0.322400</span>
<span class="co">#&gt;   [5,]  1  1.261e-01 0.307800</span>
<span class="co">#&gt;   [6,]  1  1.527e-01 0.293800</span>
<span class="co">#&gt;   [7,]  1  1.780e-01 0.280400</span>
<span class="co">#&gt;   [8,]  1  2.020e-01 0.267700</span>
<span class="co">#&gt;   [9,]  1  2.250e-01 0.255500</span>
<span class="co">#&gt;  [10,]  1  2.471e-01 0.243900</span>
<span class="co">#&gt;  [11,]  1  2.684e-01 0.232800</span>
<span class="co">#&gt;  [12,]  1  2.890e-01 0.222200</span>
<span class="co">#&gt;  [13,]  1  3.089e-01 0.212100</span>
<span class="co">#&gt;  [14,]  1  3.283e-01 0.202500</span>
<span class="co">#&gt;  [15,]  1  3.471e-01 0.193300</span>
<span class="co">#&gt;  [16,]  1  3.654e-01 0.184500</span>
<span class="co">#&gt;  [17,]  1  3.831e-01 0.176100</span>
<span class="co">#&gt;  [18,]  1  4.004e-01 0.168100</span>
<span class="co">#&gt;  [19,]  1  4.172e-01 0.160500</span>
<span class="co">#&gt;  [20,]  1  4.336e-01 0.153200</span>
<span class="co">#&gt;  [21,]  1  4.494e-01 0.146200</span>
<span class="co">#&gt;  [22,]  1  4.648e-01 0.139600</span>
<span class="co">#&gt;  [23,]  1  4.798e-01 0.133200</span>
<span class="co">#&gt;  [24,]  3  4.949e-01 0.127200</span>
<span class="co">#&gt;  [25,]  3  5.105e-01 0.121400</span>
<span class="co">#&gt;  [26,]  3  5.256e-01 0.115900</span>
<span class="co">#&gt;  [27,]  3  5.400e-01 0.110600</span>
<span class="co">#&gt;  [28,]  3  5.538e-01 0.105600</span>
<span class="co">#&gt;  [29,]  3  5.670e-01 0.100800</span>
<span class="co">#&gt;  [30,]  3  5.798e-01 0.096200</span>
<span class="co">#&gt;  [31,]  3  5.920e-01 0.091830</span>
<span class="co">#&gt;  [32,]  3  6.037e-01 0.087660</span>
<span class="co">#&gt;  [33,]  3  6.149e-01 0.083670</span>
<span class="co">#&gt;  [34,]  4  6.259e-01 0.079870</span>
<span class="co">#&gt;  [35,]  4  6.365e-01 0.076240</span>
<span class="co">#&gt;  [36,]  4  6.468e-01 0.072770</span>
<span class="co">#&gt;  [37,]  5  6.566e-01 0.069470</span>
<span class="co">#&gt;  [38,]  5  6.663e-01 0.066310</span>
<span class="co">#&gt;  [39,]  8  6.762e-01 0.063290</span>
<span class="co">#&gt;  [40,]  8  6.863e-01 0.060420</span>
<span class="co">#&gt;  [41,] 10  6.960e-01 0.057670</span>
<span class="co">#&gt;  [42,] 10  7.058e-01 0.055050</span>
<span class="co">#&gt;  [43,] 10  7.151e-01 0.052550</span>
<span class="co">#&gt;  [44,] 10  7.241e-01 0.050160</span>
<span class="co">#&gt;  [45,] 10  7.327e-01 0.047880</span>
<span class="co">#&gt;  [46,] 10  7.410e-01 0.045700</span>
<span class="co">#&gt;  [47,] 10  7.489e-01 0.043630</span>
<span class="co">#&gt;  [48,] 10  7.565e-01 0.041640</span>
<span class="co">#&gt;  [49,] 12  7.640e-01 0.039750</span>
<span class="co">#&gt;  [50,] 13  7.712e-01 0.037940</span>
<span class="co">#&gt;  [51,] 13  7.782e-01 0.036220</span>
<span class="co">#&gt;  [52,] 12  7.850e-01 0.034570</span>
<span class="co">#&gt;  [53,] 14  7.916e-01 0.033000</span>
<span class="co">#&gt;  [54,] 15  7.982e-01 0.031500</span>
<span class="co">#&gt;  [55,] 16  8.046e-01 0.030070</span>
<span class="co">#&gt;  [56,] 16  8.108e-01 0.028700</span>
<span class="co">#&gt;  [57,] 18  8.170e-01 0.027400</span>
<span class="co">#&gt;  [58,] 20  8.231e-01 0.026150</span>
<span class="co">#&gt;  [59,] 21  8.295e-01 0.024960</span>
<span class="co">#&gt;  [60,] 22  8.356e-01 0.023830</span>
<span class="co">#&gt;  [61,] 22  8.416e-01 0.022750</span>
<span class="co">#&gt;  [62,] 27  8.476e-01 0.021710</span>
<span class="co">#&gt;  [63,] 26  8.533e-01 0.020730</span>
<span class="co">#&gt;  [64,] 27  8.587e-01 0.019780</span>
<span class="co">#&gt;  [65,] 26  8.639e-01 0.018880</span>
<span class="co">#&gt;  [66,] 26  8.690e-01 0.018030</span>
<span class="co">#&gt;  [67,] 26  8.738e-01 0.017210</span>
<span class="co">#&gt;  [68,] 26  8.785e-01 0.016430</span>
<span class="co">#&gt;  [69,] 27  8.830e-01 0.015680</span>
<span class="co">#&gt;  [70,] 28  8.875e-01 0.014970</span>
<span class="co">#&gt;  [71,] 31  8.920e-01 0.014290</span>
<span class="co">#&gt;  [72,] 32  8.965e-01 0.013640</span>
<span class="co">#&gt;  [73,] 32  9.008e-01 0.013020</span>
<span class="co">#&gt;  [74,] 32  9.050e-01 0.012420</span>
<span class="co">#&gt;  [75,] 33  9.090e-01 0.011860</span>
<span class="co">#&gt;  [76,] 33  9.128e-01 0.011320</span>
<span class="co">#&gt;  [77,] 34  9.164e-01 0.010810</span>
<span class="co">#&gt;  [78,] 34  9.199e-01 0.010320</span>
<span class="co">#&gt;  [79,] 34  9.233e-01 0.009847</span>
<span class="co">#&gt;  [80,] 34  9.265e-01 0.009399</span>
<span class="co">#&gt;  [81,] 37  9.296e-01 0.008972</span>
<span class="co">#&gt;  [82,] 38  9.327e-01 0.008564</span>
<span class="co">#&gt;  [83,] 39  9.357e-01 0.008175</span>
<span class="co">#&gt;  [84,] 39  9.385e-01 0.007803</span>
<span class="co">#&gt;  [85,] 39  9.412e-01 0.007449</span>
<span class="co">#&gt;  [86,] 41  9.438e-01 0.007110</span>
<span class="co">#&gt;  [87,] 42  9.463e-01 0.006787</span>
<span class="co">#&gt;  [88,] 43  9.486e-01 0.006478</span>
<span class="co">#&gt;  [89,] 44  9.509e-01 0.006184</span>
<span class="co">#&gt;  [90,] 45  9.531e-01 0.005903</span>
<span class="co">#&gt;  [91,] 46  9.552e-01 0.005635</span>
<span class="co">#&gt;  [92,] 48  9.572e-01 0.005378</span>
<span class="co">#&gt;  [93,] 48  9.591e-01 0.005134</span>
<span class="co">#&gt;  [94,] 48  9.610e-01 0.004901</span>
<span class="co">#&gt;  [95,] 49  9.628e-01 0.004678</span>
<span class="co">#&gt;  [96,] 50  9.645e-01 0.004465</span>
<span class="co">#&gt;  [97,] 51  9.661e-01 0.004262</span>
<span class="co">#&gt;  [98,] 51  9.676e-01 0.004069</span>
<span class="co">#&gt;  [99,] 53  9.691e-01 0.003884</span>
<span class="co">#&gt; [100,] 53  9.705e-01 0.003707</span>
<span class="co">#&gt; [1] "done bootstrap 2"</span>
<span class="kw">sink</span>()</code></pre></div>
</div>
<div id="display-summary-results-for-the-prediction" class="section level2">
<h2 class="hasAnchor">
<a href="#display-summary-results-for-the-prediction" class="anchor"></a>4.2 Display summary results for the prediction</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the number of rows for the summary matrix </span>
row_cluster &lt;-<span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">colData</span>(mixedpop2)[,<span class="dv">1</span>]))

<span class="co">#summary results LDA</span>
<span class="kw"><a href="../reference/summary_prediction_lda.html">summary_prediction_lda</a></span>(<span class="dt">LSOLDA_dat=</span>LSOLDA_dat, <span class="dt">nPredSubpop =</span> row_cluster )
<span class="co">#&gt;                 V1               V2                                names</span>
<span class="co">#&gt; 1           90.625         89.84375 LDA for subpop 1 in target mixedpop2</span>
<span class="co">#&gt; 2 17.6744186046512 13.0232558139535 LDA for subpop 2 in target mixedpop2</span>
<span class="co">#&gt; 3 6.89655172413793 10.3448275862069 LDA for subpop 3 in target mixedpop2</span>

<span class="co">#summary results Lasso</span>
<span class="kw"><a href="../reference/summary_prediction_lasso.html">summary_prediction_lasso</a></span>(<span class="dt">LSOLDA_dat=</span>LSOLDA_dat, <span class="dt">nPredSubpop =</span> row_cluster)
<span class="co">#&gt;                 V1               V2                                 names</span>
<span class="co">#&gt; 1          98.4375          98.4375 LASSO for subpop1 in target mixedpop2</span>
<span class="co">#&gt; 2 6.97674418604651 2.32558139534884 LASSO for subpop2 in target mixedpop2</span>
<span class="co">#&gt; 3               NA               NA LASSO for subpop3 in target mixedpop2</span>

<span class="co">#summary deviance </span>
<span class="kw"><a href="../reference/summary_deviance.html">summary_deviance</a></span>(LSOLDA_dat)
<span class="co">#&gt; $allDeviance</span>
<span class="co">#&gt; [1] "0.5474" "0.8587"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $DeviMax</span>
<span class="co">#&gt;          Dfd   Deviance        DEgenes</span>
<span class="co">#&gt; 1          0 -1.922e-15 genes_cluster1</span>
<span class="co">#&gt; 2          1     0.4798 genes_cluster1</span>
<span class="co">#&gt; 3          3     0.6149 genes_cluster1</span>
<span class="co">#&gt; 4          4     0.6468 genes_cluster1</span>
<span class="co">#&gt; 5          5     0.6663 genes_cluster1</span>
<span class="co">#&gt; 6          8     0.6863 genes_cluster1</span>
<span class="co">#&gt; 7         10     0.7565 genes_cluster1</span>
<span class="co">#&gt; 8         12      0.785 genes_cluster1</span>
<span class="co">#&gt; 9         13     0.7782 genes_cluster1</span>
<span class="co">#&gt; 10        14     0.7916 genes_cluster1</span>
<span class="co">#&gt; 11        15     0.7982 genes_cluster1</span>
<span class="co">#&gt; 12        16     0.8108 genes_cluster1</span>
<span class="co">#&gt; 13        18      0.817 genes_cluster1</span>
<span class="co">#&gt; 14        20     0.8231 genes_cluster1</span>
<span class="co">#&gt; 15        21     0.8295 genes_cluster1</span>
<span class="co">#&gt; 16        22     0.8416 genes_cluster1</span>
<span class="co">#&gt; 17        26      0.869 genes_cluster1</span>
<span class="co">#&gt; 18        27     0.8587 genes_cluster1</span>
<span class="co">#&gt; 19 remaining          1        DEgenes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LassoGenesMax</span>
<span class="co">#&gt;                                      1                      name</span>
<span class="co">#&gt; (Intercept)               -7.603438852               (Intercept)</span>
<span class="co">#&gt; MAD2L2_ENSG00000116670    -0.076623225    MAD2L2_ENSG00000116670</span>
<span class="co">#&gt; YARS_ENSG00000134684       0.070252994      YARS_ENSG00000134684</span>
<span class="co">#&gt; UROD_ENSG00000126088       0.049260366      UROD_ENSG00000126088</span>
<span class="co">#&gt; ODF2L_ENSG00000122417      0.032596097     ODF2L_ENSG00000122417</span>
<span class="co">#&gt; S100A16_ENSG00000188643   -0.022456887   S100A16_ENSG00000188643</span>
<span class="co">#&gt; GLUL_ENSG00000135821      -0.027925350      GLUL_ENSG00000135821</span>
<span class="co">#&gt; OST4_ENSG00000228474       0.025512675      OST4_ENSG00000228474</span>
<span class="co">#&gt; HNRNPDL_ENSG00000152795    0.004939132   HNRNPDL_ENSG00000152795</span>
<span class="co">#&gt; PTPN13_ENSG00000163629     0.229537757    PTPN13_ENSG00000163629</span>
<span class="co">#&gt; GUCY1A3_ENSG00000164116    0.021131626   GUCY1A3_ENSG00000164116</span>
<span class="co">#&gt; LIX1_ENSG00000145721       0.008554550      LIX1_ENSG00000145721</span>
<span class="co">#&gt; SRP19_ENSG00000153037      0.062859279     SRP19_ENSG00000153037</span>
<span class="co">#&gt; CITED2_ENSG00000164442     0.022081547    CITED2_ENSG00000164442</span>
<span class="co">#&gt; C1GALT1_ENSG00000106392    0.026308736   C1GALT1_ENSG00000106392</span>
<span class="co">#&gt; SRI_ENSG00000075142        0.026781442       SRI_ENSG00000075142</span>
<span class="co">#&gt; BEX3_ENSG00000166681       0.021052614      BEX3_ENSG00000166681</span>
<span class="co">#&gt; TMEM185A_ENSG00000269556   0.018527206  TMEM185A_ENSG00000269556</span>
<span class="co">#&gt; CTSV_ENSG00000136943       0.037950936      CTSV_ENSG00000136943</span>
<span class="co">#&gt; MDK_ENSG00000110492        0.005666654       MDK_ENSG00000110492</span>
<span class="co">#&gt; MALAT1_ENSG00000251562     0.021682281    MALAT1_ENSG00000251562</span>
<span class="co">#&gt; TAGLN_ENSG00000149591      0.017395844     TAGLN_ENSG00000149591</span>
<span class="co">#&gt; TJP1_ENSG00000104067       0.005512594      TJP1_ENSG00000104067</span>
<span class="co">#&gt; TNFRSF12A_ENSG00000006327  0.006926831 TNFRSF12A_ENSG00000006327</span>
<span class="co">#&gt; ACADVL_ENSG00000072778     0.073721491    ACADVL_ENSG00000072778</span>
<span class="co">#&gt; ISYNA1_ENSG00000105655     0.053416749    ISYNA1_ENSG00000105655</span>
<span class="co">#&gt; COL6A1_ENSG00000142156     0.011132011    COL6A1_ENSG00000142156</span></code></pre></div>
</div>
<div id="plot-the-relationship-between-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-relationship-between-clusters" class="anchor"></a>4.3 Plot the relationship between clusters</h2>
<p><em>Here we look at one example use case to find relationship between clusters within one sample or between two sample</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#run prediction for 3 clusters </span>

c_selectID &lt;-<span class="st"> </span><span class="dv">1</span>
genes =<span class="st"> </span>DEgenes<span class="op">$</span>DE_Subpop1vsRemaining<span class="op">$</span>id[<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>] <span class="co">#top 200 gene markers distinguishing cluster 1 </span>
genes &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, genes)

LSOLDA_dat1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">1</span>,<span class="dt">mixedpop1 =</span> mixedpop2, <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes=</span>genes, c_selectID, <span class="dt">listData =</span><span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Df       %Dev    Lambda</span>
<span class="co">#&gt;  [1,]  0 -1.922e-15 3.503e-01</span>
<span class="co">#&gt;  [2,]  1  6.105e-02 3.192e-01</span>
<span class="co">#&gt;  [3,]  1  1.159e-01 2.909e-01</span>
<span class="co">#&gt;  [4,]  1  1.671e-01 2.650e-01</span>
<span class="co">#&gt;  [5,]  1  2.152e-01 2.415e-01</span>
<span class="co">#&gt;  [6,]  1  2.603e-01 2.200e-01</span>
<span class="co">#&gt;  [7,]  1  3.027e-01 2.005e-01</span>
<span class="co">#&gt;  [8,]  1  3.426e-01 1.827e-01</span>
<span class="co">#&gt;  [9,]  1  3.801e-01 1.664e-01</span>
<span class="co">#&gt; [10,]  1  4.153e-01 1.517e-01</span>
<span class="co">#&gt; [11,]  1  4.483e-01 1.382e-01</span>
<span class="co">#&gt; [12,]  2  4.801e-01 1.259e-01</span>
<span class="co">#&gt; [13,]  2  5.102e-01 1.147e-01</span>
<span class="co">#&gt; [14,]  2  5.380e-01 1.045e-01</span>
<span class="co">#&gt; [15,]  3  5.641e-01 9.524e-02</span>
<span class="co">#&gt; [16,]  3  5.888e-01 8.678e-02</span>
<span class="co">#&gt; [17,]  4  6.117e-01 7.907e-02</span>
<span class="co">#&gt; [18,]  6  6.337e-01 7.205e-02</span>
<span class="co">#&gt; [19,]  6  6.542e-01 6.565e-02</span>
<span class="co">#&gt; [20,]  7  6.733e-01 5.981e-02</span>
<span class="co">#&gt; [21,]  8  6.911e-01 5.450e-02</span>
<span class="co">#&gt; [22,]  9  7.081e-01 4.966e-02</span>
<span class="co">#&gt; [23,] 10  7.241e-01 4.525e-02</span>
<span class="co">#&gt; [24,] 11  7.397e-01 4.123e-02</span>
<span class="co">#&gt; [25,] 13  7.546e-01 3.757e-02</span>
<span class="co">#&gt; [26,] 13  7.683e-01 3.423e-02</span>
<span class="co">#&gt; [27,] 14  7.809e-01 3.119e-02</span>
<span class="co">#&gt; [28,] 14  7.926e-01 2.842e-02</span>
<span class="co">#&gt; [29,] 16  8.037e-01 2.589e-02</span>
<span class="co">#&gt; [30,] 18  8.143e-01 2.359e-02</span>
<span class="co">#&gt; [31,] 18  8.242e-01 2.150e-02</span>
<span class="co">#&gt; [32,] 19  8.336e-01 1.959e-02</span>
<span class="co">#&gt; [33,] 21  8.427e-01 1.785e-02</span>
<span class="co">#&gt; [34,] 22  8.529e-01 1.626e-02</span>
<span class="co">#&gt; [35,] 23  8.628e-01 1.482e-02</span>
<span class="co">#&gt; [36,] 26  8.724e-01 1.350e-02</span>
<span class="co">#&gt; [37,] 28  8.816e-01 1.230e-02</span>
<span class="co">#&gt; [38,] 27  8.903e-01 1.121e-02</span>
<span class="co">#&gt; [39,] 27  8.983e-01 1.021e-02</span>
<span class="co">#&gt; [40,] 26  9.057e-01 9.305e-03</span>
<span class="co">#&gt; [41,] 26  9.125e-01 8.479e-03</span>
<span class="co">#&gt; [42,] 25  9.189e-01 7.725e-03</span>
<span class="co">#&gt; [43,] 26  9.248e-01 7.039e-03</span>
<span class="co">#&gt; [44,] 26  9.304e-01 6.414e-03</span>
<span class="co">#&gt; [45,] 28  9.355e-01 5.844e-03</span>
<span class="co">#&gt; [46,] 29  9.406e-01 5.325e-03</span>
<span class="co">#&gt; [47,] 30  9.453e-01 4.852e-03</span>
<span class="co">#&gt; [48,] 31  9.498e-01 4.421e-03</span>
<span class="co">#&gt; [49,] 32  9.539e-01 4.028e-03</span>
<span class="co">#&gt; [50,] 35  9.577e-01 3.670e-03</span>
<span class="co">#&gt; [51,] 36  9.612e-01 3.344e-03</span>
<span class="co">#&gt; [52,] 39  9.645e-01 3.047e-03</span>
<span class="co">#&gt; [53,] 40  9.676e-01 2.776e-03</span>
<span class="co">#&gt; [54,] 39  9.704e-01 2.530e-03</span>
<span class="co">#&gt; [55,] 39  9.729e-01 2.305e-03</span>
<span class="co">#&gt; [56,] 40  9.753e-01 2.100e-03</span>
<span class="co">#&gt; [57,] 40  9.774e-01 1.914e-03</span>
<span class="co">#&gt; [58,] 41  9.794e-01 1.744e-03</span>
<span class="co">#&gt; [59,] 42  9.812e-01 1.589e-03</span>
<span class="co">#&gt; [60,] 43  9.828e-01 1.448e-03</span>
<span class="co">#&gt; [61,] 44  9.843e-01 1.319e-03</span>
<span class="co">#&gt; [62,] 45  9.857e-01 1.202e-03</span>
<span class="co">#&gt; [63,] 45  9.870e-01 1.095e-03</span>
<span class="co">#&gt; [64,] 45  9.881e-01 9.978e-04</span>
<span class="co">#&gt; [65,] 47  9.892e-01 9.091e-04</span>
<span class="co">#&gt; [66,] 47  9.901e-01 8.284e-04</span>
<span class="co">#&gt; [67,] 49  9.910e-01 7.548e-04</span>
<span class="co">#&gt; [68,] 48  9.918e-01 6.877e-04</span>
<span class="co">#&gt; [69,] 49  9.925e-01 6.266e-04</span>
<span class="co">#&gt; [70,] 51  9.932e-01 5.710e-04</span>
<span class="co">#&gt; [71,] 54  9.938e-01 5.202e-04</span>
<span class="co">#&gt; [72,] 53  9.943e-01 4.740e-04</span>
<span class="co">#&gt; [73,] 53  9.948e-01 4.319e-04</span>
<span class="co">#&gt; [74,] 53  9.953e-01 3.935e-04</span>
<span class="co">#&gt; [75,] 53  9.957e-01 3.586e-04</span>
<span class="co">#&gt; [76,] 53  9.961e-01 3.267e-04</span>
<span class="co">#&gt; [77,] 53  9.964e-01 2.977e-04</span>
<span class="co">#&gt; [78,] 54  9.968e-01 2.713e-04</span>
<span class="co">#&gt; [79,] 54  9.970e-01 2.472e-04</span>
<span class="co">#&gt; [80,] 54  9.973e-01 2.252e-04</span>
<span class="co">#&gt; [81,] 54  9.975e-01 2.052e-04</span>
<span class="co">#&gt; [82,] 54  9.978e-01 1.870e-04</span>
<span class="co">#&gt; [83,] 54  9.980e-01 1.704e-04</span>
<span class="co">#&gt; [84,] 55  9.981e-01 1.552e-04</span>
<span class="co">#&gt; [85,] 55  9.983e-01 1.414e-04</span>
<span class="co">#&gt; [86,] 55  9.985e-01 1.289e-04</span>
<span class="co">#&gt; [87,] 55  9.986e-01 1.174e-04</span>
<span class="co">#&gt; [88,] 55  9.987e-01 1.070e-04</span>
<span class="co">#&gt; [89,] 55  9.988e-01 9.748e-05</span>
<span class="co">#&gt; [90,] 55  9.989e-01 8.882e-05</span>
<span class="co">#&gt; [91,] 55  9.990e-01 8.093e-05</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>


c_selectID &lt;-<span class="st"> </span><span class="dv">2</span>
genes =<span class="st"> </span>DEgenes<span class="op">$</span>DE_Subpop2vsRemaining<span class="op">$</span>id[<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>]
genes &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, genes)
LSOLDA_dat2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">1</span>,<span class="dt">mixedpop1 =</span> mixedpop2, <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes=</span>genes, c_selectID, <span class="dt">listData =</span><span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       Df       %Dev    Lambda</span>
<span class="co">#&gt;  [1,]  0 -2.403e-15 2.613e-01</span>
<span class="co">#&gt;  [2,]  1  3.357e-02 2.381e-01</span>
<span class="co">#&gt;  [3,]  1  6.195e-02 2.170e-01</span>
<span class="co">#&gt;  [4,]  2  9.456e-02 1.977e-01</span>
<span class="co">#&gt;  [5,]  3  1.270e-01 1.801e-01</span>
<span class="co">#&gt;  [6,]  6  1.592e-01 1.641e-01</span>
<span class="co">#&gt;  [7,]  6  1.908e-01 1.495e-01</span>
<span class="co">#&gt;  [8,]  6  2.182e-01 1.363e-01</span>
<span class="co">#&gt;  [9,]  9  2.442e-01 1.242e-01</span>
<span class="co">#&gt; [10,] 13  2.714e-01 1.131e-01</span>
<span class="co">#&gt; [11,] 16  3.002e-01 1.031e-01</span>
<span class="co">#&gt; [12,] 16  3.281e-01 9.392e-02</span>
<span class="co">#&gt; [13,] 20  3.547e-01 8.558e-02</span>
<span class="co">#&gt; [14,] 22  3.802e-01 7.798e-02</span>
<span class="co">#&gt; [15,] 25  4.065e-01 7.105e-02</span>
<span class="co">#&gt; [16,] 26  4.312e-01 6.474e-02</span>
<span class="co">#&gt; [17,] 29  4.550e-01 5.899e-02</span>
<span class="co">#&gt; [18,] 27  4.776e-01 5.375e-02</span>
<span class="co">#&gt; [19,] 29  4.987e-01 4.897e-02</span>
<span class="co">#&gt; [20,] 29  5.183e-01 4.462e-02</span>
<span class="co">#&gt; [21,] 33  5.368e-01 4.066e-02</span>
<span class="co">#&gt; [22,] 32  5.542e-01 3.704e-02</span>
<span class="co">#&gt; [23,] 33  5.701e-01 3.375e-02</span>
<span class="co">#&gt; [24,] 35  5.856e-01 3.076e-02</span>
<span class="co">#&gt; [25,] 35  6.016e-01 2.802e-02</span>
<span class="co">#&gt; [26,] 37  6.175e-01 2.553e-02</span>
<span class="co">#&gt; [27,] 40  6.337e-01 2.327e-02</span>
<span class="co">#&gt; [28,] 41  6.496e-01 2.120e-02</span>
<span class="co">#&gt; [29,] 43  6.645e-01 1.932e-02</span>
<span class="co">#&gt; [30,] 48  6.812e-01 1.760e-02</span>
<span class="co">#&gt; [31,] 48  7.003e-01 1.604e-02</span>
<span class="co">#&gt; [32,] 51  7.184e-01 1.461e-02</span>
<span class="co">#&gt; [33,] 53  7.358e-01 1.331e-02</span>
<span class="co">#&gt; [34,] 56  7.540e-01 1.213e-02</span>
<span class="co">#&gt; [35,] 59  7.715e-01 1.105e-02</span>
<span class="co">#&gt; [36,] 63  7.882e-01 1.007e-02</span>
<span class="co">#&gt; [37,] 66  8.044e-01 9.176e-03</span>
<span class="co">#&gt; [38,] 65  8.196e-01 8.361e-03</span>
<span class="co">#&gt; [39,] 66  8.336e-01 7.618e-03</span>
<span class="co">#&gt; [40,] 69  8.468e-01 6.941e-03</span>
<span class="co">#&gt; [41,] 72  8.594e-01 6.325e-03</span>
<span class="co">#&gt; [42,] 75  8.711e-01 5.763e-03</span>
<span class="co">#&gt; [43,] 76  8.823e-01 5.251e-03</span>
<span class="co">#&gt; [44,] 76  8.924e-01 4.784e-03</span>
<span class="co">#&gt; [45,] 79  9.018e-01 4.359e-03</span>
<span class="co">#&gt; [46,] 80  9.105e-01 3.972e-03</span>
<span class="co">#&gt; [47,] 78  9.184e-01 3.619e-03</span>
<span class="co">#&gt; [48,] 79  9.258e-01 3.298e-03</span>
<span class="co">#&gt; [49,] 79  9.323e-01 3.005e-03</span>
<span class="co">#&gt; [50,] 80  9.383e-01 2.738e-03</span>
<span class="co">#&gt; [51,] 80  9.438e-01 2.495e-03</span>
<span class="co">#&gt; [52,] 81  9.488e-01 2.273e-03</span>
<span class="co">#&gt; [53,] 83  9.534e-01 2.071e-03</span>
<span class="co">#&gt; [54,] 83  9.576e-01 1.887e-03</span>
<span class="co">#&gt; [55,] 84  9.614e-01 1.719e-03</span>
<span class="co">#&gt; [56,] 84  9.648e-01 1.567e-03</span>
<span class="co">#&gt; [57,] 84  9.680e-01 1.428e-03</span>
<span class="co">#&gt; [58,] 83  9.708e-01 1.301e-03</span>
<span class="co">#&gt; [59,] 84  9.734e-01 1.185e-03</span>
<span class="co">#&gt; [60,] 84  9.758e-01 1.080e-03</span>
<span class="co">#&gt; [61,] 84  9.780e-01 9.839e-04</span>
<span class="co">#&gt; [62,] 85  9.799e-01 8.965e-04</span>
<span class="co">#&gt; [63,] 85  9.817e-01 8.169e-04</span>
<span class="co">#&gt; [64,] 86  9.833e-01 7.443e-04</span>
<span class="co">#&gt; [65,] 86  9.848e-01 6.782e-04</span>
<span class="co">#&gt; [66,] 87  9.862e-01 6.179e-04</span>
<span class="co">#&gt; [67,] 87  9.874e-01 5.630e-04</span>
<span class="co">#&gt; [68,] 88  9.885e-01 5.130e-04</span>
<span class="co">#&gt; [69,] 88  9.895e-01 4.674e-04</span>
<span class="co">#&gt; [70,] 88  9.905e-01 4.259e-04</span>
<span class="co">#&gt; [71,] 89  9.913e-01 3.881e-04</span>
<span class="co">#&gt; [72,] 89  9.921e-01 3.536e-04</span>
<span class="co">#&gt; [73,] 90  9.928e-01 3.222e-04</span>
<span class="co">#&gt; [74,] 90  9.934e-01 2.936e-04</span>
<span class="co">#&gt; [75,] 90  9.940e-01 2.675e-04</span>
<span class="co">#&gt; [76,] 90  9.945e-01 2.437e-04</span>
<span class="co">#&gt; [77,] 90  9.950e-01 2.221e-04</span>
<span class="co">#&gt; [78,] 90  9.955e-01 2.023e-04</span>
<span class="co">#&gt; [79,] 90  9.959e-01 1.844e-04</span>
<span class="co">#&gt; [80,] 91  9.962e-01 1.680e-04</span>
<span class="co">#&gt; [81,] 91  9.966e-01 1.531e-04</span>
<span class="co">#&gt; [82,] 90  9.969e-01 1.395e-04</span>
<span class="co">#&gt; [83,] 90  9.971e-01 1.271e-04</span>
<span class="co">#&gt; [84,] 90  9.974e-01 1.158e-04</span>
<span class="co">#&gt; [85,] 90  9.976e-01 1.055e-04</span>
<span class="co">#&gt; [86,] 91  9.978e-01 9.613e-05</span>
<span class="co">#&gt; [87,] 91  9.980e-01 8.759e-05</span>
<span class="co">#&gt; [88,] 91  9.982e-01 7.981e-05</span>
<span class="co">#&gt; [89,] 91  9.984e-01 7.272e-05</span>
<span class="co">#&gt; [90,] 90  9.985e-01 6.626e-05</span>
<span class="co">#&gt; [91,] 90  9.986e-01 6.037e-05</span>
<span class="co">#&gt; [92,] 92  9.988e-01 5.501e-05</span>
<span class="co">#&gt; [93,] 92  9.989e-01 5.012e-05</span>
<span class="co">#&gt; [94,] 92  9.990e-01 4.567e-05</span>
<span class="co">#&gt; [95,] 92  9.991e-01 4.161e-05</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>


c_selectID &lt;-<span class="st"> </span><span class="dv">3</span>
genes =<span class="st"> </span>DEgenes<span class="op">$</span>DE_Subpop3vsRemaining<span class="op">$</span>id[<span class="dv">1</span><span class="op">:</span><span class="dv">200</span>]
genes &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"_.*"</span>, <span class="st">""</span>, genes)
LSOLDA_dat3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bootstrap_scGPS.html">bootstrap_scGPS</a></span>(<span class="dt">nboots =</span> <span class="dv">1</span>,<span class="dt">mixedpop1 =</span> mixedpop2, <span class="dt">mixedpop2 =</span> mixedpop2, <span class="dt">genes=</span>genes, c_selectID, <span class="dt">listData =</span><span class="kw">list</span>())
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glmnet(x = t(predictor_S1), y = y_cat, family = "binomial") </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        Df    %Dev   Lambda</span>
<span class="co">#&gt;   [1,]  0 0.00000 0.469900</span>
<span class="co">#&gt;   [2,]  1 0.05664 0.448500</span>
<span class="co">#&gt;   [3,]  1 0.10850 0.428100</span>
<span class="co">#&gt;   [4,]  1 0.15630 0.408700</span>
<span class="co">#&gt;   [5,]  1 0.20030 0.390100</span>
<span class="co">#&gt;   [6,]  1 0.24120 0.372400</span>
<span class="co">#&gt;   [7,]  1 0.27920 0.355400</span>
<span class="co">#&gt;   [8,]  1 0.31470 0.339300</span>
<span class="co">#&gt;   [9,]  1 0.34780 0.323900</span>
<span class="co">#&gt;  [10,]  1 0.37890 0.309100</span>
<span class="co">#&gt;  [11,]  1 0.40810 0.295100</span>
<span class="co">#&gt;  [12,]  1 0.43550 0.281700</span>
<span class="co">#&gt;  [13,]  1 0.46140 0.268900</span>
<span class="co">#&gt;  [14,]  1 0.48580 0.256700</span>
<span class="co">#&gt;  [15,]  1 0.50890 0.245000</span>
<span class="co">#&gt;  [16,]  1 0.53070 0.233900</span>
<span class="co">#&gt;  [17,]  1 0.55130 0.223200</span>
<span class="co">#&gt;  [18,]  1 0.57090 0.213100</span>
<span class="co">#&gt;  [19,]  1 0.58950 0.203400</span>
<span class="co">#&gt;  [20,]  1 0.60720 0.194200</span>
<span class="co">#&gt;  [21,]  1 0.62400 0.185300</span>
<span class="co">#&gt;  [22,]  1 0.64000 0.176900</span>
<span class="co">#&gt;  [23,]  1 0.65520 0.168900</span>
<span class="co">#&gt;  [24,]  1 0.66960 0.161200</span>
<span class="co">#&gt;  [25,]  1 0.68350 0.153900</span>
<span class="co">#&gt;  [26,]  1 0.69660 0.146900</span>
<span class="co">#&gt;  [27,]  1 0.70920 0.140200</span>
<span class="co">#&gt;  [28,]  1 0.72120 0.133800</span>
<span class="co">#&gt;  [29,]  1 0.73260 0.127700</span>
<span class="co">#&gt;  [30,]  1 0.74360 0.121900</span>
<span class="co">#&gt;  [31,]  1 0.75400 0.116400</span>
<span class="co">#&gt;  [32,]  1 0.76400 0.111100</span>
<span class="co">#&gt;  [33,]  1 0.77360 0.106100</span>
<span class="co">#&gt;  [34,]  1 0.78270 0.101200</span>
<span class="co">#&gt;  [35,]  1 0.79150 0.096630</span>
<span class="co">#&gt;  [36,]  1 0.79980 0.092240</span>
<span class="co">#&gt;  [37,]  1 0.80790 0.088050</span>
<span class="co">#&gt;  [38,]  1 0.81550 0.084040</span>
<span class="co">#&gt;  [39,]  1 0.82290 0.080220</span>
<span class="co">#&gt;  [40,]  1 0.82990 0.076580</span>
<span class="co">#&gt;  [41,]  1 0.83670 0.073100</span>
<span class="co">#&gt;  [42,]  1 0.84320 0.069770</span>
<span class="co">#&gt;  [43,]  1 0.84940 0.066600</span>
<span class="co">#&gt;  [44,]  1 0.85530 0.063580</span>
<span class="co">#&gt;  [45,]  1 0.86100 0.060690</span>
<span class="co">#&gt;  [46,]  1 0.86650 0.057930</span>
<span class="co">#&gt;  [47,]  1 0.87170 0.055300</span>
<span class="co">#&gt;  [48,]  1 0.87680 0.052780</span>
<span class="co">#&gt;  [49,]  1 0.88160 0.050380</span>
<span class="co">#&gt;  [50,]  2 0.88640 0.048090</span>
<span class="co">#&gt;  [51,]  2 0.89120 0.045910</span>
<span class="co">#&gt;  [52,]  3 0.89590 0.043820</span>
<span class="co">#&gt;  [53,]  3 0.90030 0.041830</span>
<span class="co">#&gt;  [54,]  3 0.90460 0.039930</span>
<span class="co">#&gt;  [55,]  4 0.90870 0.038110</span>
<span class="co">#&gt;  [56,]  4 0.91260 0.036380</span>
<span class="co">#&gt;  [57,]  4 0.91640 0.034730</span>
<span class="co">#&gt;  [58,]  4 0.92000 0.033150</span>
<span class="co">#&gt;  [59,]  6 0.92340 0.031640</span>
<span class="co">#&gt;  [60,]  6 0.92690 0.030200</span>
<span class="co">#&gt;  [61,]  7 0.93020 0.028830</span>
<span class="co">#&gt;  [62,]  7 0.93340 0.027520</span>
<span class="co">#&gt;  [63,]  7 0.93650 0.026270</span>
<span class="co">#&gt;  [64,]  8 0.93940 0.025080</span>
<span class="co">#&gt;  [65,]  9 0.94220 0.023940</span>
<span class="co">#&gt;  [66,]  8 0.94490 0.022850</span>
<span class="co">#&gt;  [67,]  8 0.94740 0.021810</span>
<span class="co">#&gt;  [68,]  8 0.94980 0.020820</span>
<span class="co">#&gt;  [69,]  8 0.95210 0.019870</span>
<span class="co">#&gt;  [70,]  8 0.95430 0.018970</span>
<span class="co">#&gt;  [71,]  8 0.95640 0.018110</span>
<span class="co">#&gt;  [72,]  8 0.95840 0.017280</span>
<span class="co">#&gt;  [73,]  8 0.96030 0.016500</span>
<span class="co">#&gt;  [74,]  8 0.96210 0.015750</span>
<span class="co">#&gt;  [75,]  8 0.96380 0.015030</span>
<span class="co">#&gt;  [76,]  8 0.96540 0.014350</span>
<span class="co">#&gt;  [77,]  8 0.96700 0.013700</span>
<span class="co">#&gt;  [78,]  8 0.96850 0.013070</span>
<span class="co">#&gt;  [79,]  8 0.96990 0.012480</span>
<span class="co">#&gt;  [80,]  7 0.97130 0.011910</span>
<span class="co">#&gt;  [81,]  7 0.97260 0.011370</span>
<span class="co">#&gt;  [82,]  7 0.97380 0.010850</span>
<span class="co">#&gt;  [83,]  7 0.97500 0.010360</span>
<span class="co">#&gt;  [84,]  7 0.97610 0.009890</span>
<span class="co">#&gt;  [85,]  7 0.97720 0.009441</span>
<span class="co">#&gt;  [86,]  7 0.97820 0.009012</span>
<span class="co">#&gt;  [87,]  7 0.97920 0.008602</span>
<span class="co">#&gt;  [88,]  7 0.98010 0.008211</span>
<span class="co">#&gt;  [89,]  9 0.98100 0.007838</span>
<span class="co">#&gt;  [90,]  9 0.98190 0.007482</span>
<span class="co">#&gt;  [91,]  9 0.98270 0.007142</span>
<span class="co">#&gt;  [92,]  9 0.98350 0.006817</span>
<span class="co">#&gt;  [93,]  9 0.98430 0.006507</span>
<span class="co">#&gt;  [94,]  9 0.98500 0.006211</span>
<span class="co">#&gt;  [95,]  9 0.98570 0.005929</span>
<span class="co">#&gt;  [96,]  9 0.98630 0.005660</span>
<span class="co">#&gt;  [97,]  9 0.98690 0.005402</span>
<span class="co">#&gt;  [98,]  9 0.98750 0.005157</span>
<span class="co">#&gt;  [99,]  9 0.98810 0.004922</span>
<span class="co">#&gt; [100,]  9 0.98870 0.004699</span>
<span class="co">#&gt; [1] "done bootstrap 1"</span>

<span class="co">#prepare table input for sankey plot </span>

reformat_LASSO &lt;-<span class="cf">function</span>(<span class="dt">c_selectID =</span> <span class="ot">NULL</span>, <span class="dt">s_selectID =</span> <span class="ot">NULL</span>, <span class="dt">LSOLDA_dat =</span> <span class="ot">NULL</span>, 
                          <span class="dt">nPredSubpop =</span> row_cluster, <span class="dt">Nodes_group =</span> <span class="st">"#7570b3"</span>){
  LASSO_out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/summary_prediction_lasso.html">summary_prediction_lasso</a></span>(<span class="dt">LSOLDA_dat=</span>LSOLDA_dat, <span class="dt">nPredSubpop =</span> nPredSubpop)
  LASSO_out &lt;-<span class="kw">as.data.frame</span>(LASSO_out)
  temp_name &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"LASSO for subpop"</span>, <span class="st">"C"</span>, LASSO_out<span class="op">$</span>names)
  temp_name &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">" in target mixedpop"</span>, <span class="st">"S"</span>, temp_name)
  LASSO_out<span class="op">$</span>names &lt;-temp_name
  source &lt;-<span class="kw">rep</span>(<span class="kw">paste0</span>(<span class="st">"C"</span>,c_selectID,<span class="st">"S"</span>,s_selectID), <span class="kw">length</span>(temp_name))
  LASSO_out<span class="op">$</span>Source &lt;-<span class="st"> </span>source
  LASSO_out<span class="op">$</span>Node &lt;-<span class="st"> </span>source
  LASSO_out<span class="op">$</span>Nodes_group &lt;-<span class="st"> </span><span class="kw">rep</span>(Nodes_group, <span class="kw">length</span>(temp_name))
  <span class="kw">colnames</span>(LASSO_out) &lt;-<span class="kw">c</span>(<span class="st">"Value"</span>, <span class="st">"Target"</span>, <span class="st">"Source"</span>, <span class="st">"Node"</span>, <span class="st">"NodeGroup"</span>)
  LASSO_out<span class="op">$</span>Value &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.vector</span>(LASSO_out<span class="op">$</span>Value))
  <span class="kw">return</span>(LASSO_out)
}

LASSO_C1S2  &lt;-<span class="st"> </span><span class="kw">reformat_LASSO</span>(<span class="dt">c_selectID=</span><span class="dv">1</span>, <span class="dt">s_selectID =</span><span class="dv">2</span>, <span class="dt">LSOLDA_dat=</span>LSOLDA_dat1, 
                          <span class="dt">nPredSubpop =</span> row_cluster, <span class="dt">Nodes_group =</span> <span class="st">"#7570b3"</span>)

LASSO_C2S2  &lt;-<span class="st"> </span><span class="kw">reformat_LASSO</span>(<span class="dt">c_selectID=</span><span class="dv">2</span>, <span class="dt">s_selectID =</span><span class="dv">2</span>, <span class="dt">LSOLDA_dat=</span>LSOLDA_dat2, 
                          <span class="dt">nPredSubpop =</span> row_cluster, <span class="dt">Nodes_group =</span> <span class="st">"#1b9e77"</span>)

LASSO_C3S2  &lt;-<span class="st"> </span><span class="kw">reformat_LASSO</span>(<span class="dt">c_selectID=</span><span class="dv">3</span>, <span class="dt">s_selectID =</span><span class="dv">2</span>, <span class="dt">LSOLDA_dat=</span>LSOLDA_dat3, 
                          <span class="dt">nPredSubpop =</span> row_cluster, <span class="dt">Nodes_group =</span> <span class="st">"#e7298a"</span>)


combined &lt;-<span class="st"> </span><span class="kw">rbind</span>(LASSO_C1S2,LASSO_C2S2,LASSO_C3S2 )
combined &lt;-<span class="st"> </span>combined[<span class="kw">is.na</span>(combined<span class="op">$</span>Value) <span class="op">!=</span><span class="st"> </span><span class="ot">TRUE</span>,]
combined_D3obj &lt;-<span class="kw">list</span>(<span class="dt">Nodes=</span>combined[,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">Links=</span>combined[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>)])

<span class="kw">library</span>(networkD3)

Node_source &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Source)))
Node_target &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">sort</span>(<span class="kw">unique</span>(combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Target)))
Node_all &lt;-<span class="kw">unique</span>(<span class="kw">c</span>(Node_source, Node_target))

<span class="co">#assign IDs for Source (start from 0)</span>
Source &lt;-combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Source
Target &lt;-<span class="st"> </span>combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Target

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Node_all)){
  Source[Source<span class="op">==</span>Node_all[i]] &lt;-i<span class="op">-</span><span class="dv">1</span>
  Target[Target<span class="op">==</span>Node_all[i]] &lt;-i<span class="op">-</span><span class="dv">1</span>
}

combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Source &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Source)
combined_D3obj<span class="op">$</span>Links<span class="op">$</span>Target &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Target)
combined_D3obj<span class="op">$</span>Links<span class="op">$</span>LinkColor &lt;-<span class="st"> </span>combined<span class="op">$</span>NodeGroup

<span class="co">#prepare node info </span>
node_df &lt;-<span class="kw">data.frame</span>(<span class="dt">Node=</span>Node_all)
node_df<span class="op">$</span>id &lt;-<span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(Node_all)<span class="op">-</span><span class="dv">1</span>)))

<span class="kw">suppressMessages</span>(<span class="kw">library</span>(dplyr))
Color &lt;-<span class="st"> </span>combined <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(Node, <span class="dt">color=</span>NodeGroup) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="dv">2</span>)
node_df<span class="op">$</span>color &lt;-<span class="st"> </span>Color<span class="op">$</span>color

<span class="kw">suppressMessages</span>(<span class="kw">library</span>(networkD3))
p1&lt;-<span class="kw"><a href="http://www.rdocumentation.org/packages/networkD3/topics/sankeyNetwork">sankeyNetwork</a></span>(<span class="dt">Links =</span>combined_D3obj<span class="op">$</span>Links, <span class="dt">Nodes =</span> node_df,  <span class="dt">Value =</span> <span class="st">"Value"</span>, <span class="dt">NodeGroup =</span><span class="st">"color"</span>, <span class="dt">LinkGroup =</span> <span class="st">"LinkColor"</span>, <span class="dt">NodeID=</span><span class="st">"Node"</span>, <span class="dt">Source=</span><span class="st">"Source"</span>, <span class="dt">Target=</span><span class="st">"Target"</span>, 
                  <span class="dt">fontSize =</span> <span class="dv">22</span> )
p1</code></pre></div>
<div id="htmlwidget-ac4b9b3828917a9b9214" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac4b9b3828917a9b9214">{"x":{"links":{"source":[0,0,1,1,1,2,2],"target":[0,1,0,1,2,1,2],"value":[96.09375,3.72093023255814,17.1875,90.6976744186046,75.8620689655172,9.76744186046512,100],"group":["#7570b3","#7570b3","#1b9e77","#1b9e77","#1b9e77","#e7298a","#e7298a"]},"nodes":{"name":["C1S2","C2S2","C3S2"],"group":["#7570b3","#1b9e77","#e7298a"]},"options":{"NodeID":"Node","NodeGroup":"color","LinkGroup":"LinkColor","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":22,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co">#saveNetwork(p1, file = paste0(path,'Subpopulation_Net.html'))</span>
##R Setting Information
<span class="co">#sessionInfo()</span>
<span class="co">#rmarkdown::render("/Users/quan.nguyen/Documents/Powell_group_MacQuan/AllCodes/scGPS/vignettes/vignette.Rmd",html_document(toc = TRUE, toc_depth = 3))</span>
<span class="co">#rmarkdown::render("/Users/quan.nguyen/Documents/Powell_group_MacQuan/AllCodes/scGPS/vignettes/vignette.Rmd",pdf_document(toc = TRUE, toc_depth = 3))</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation-instruction">1. Installation instruction</a></li>
      <li>
<a href="#a-simple-workflow-of-the-scgps">2. A simple workflow of the scGPS:</a><ul class="nav nav-pills nav-stacked">
<li><a href="#setup-scgps-objects">2.1 Setup scGPS objects</a></li>
      <li><a href="#run-predictions">2.2 Run predictions</a></li>
      <li><a href="#summarise-results">2.3 Summarise results</a></li>
      </ul>
</li>
      <li>
<a href="#a-complete-workflow-of-the-scgps">3. A complete workflow of the scGPS:</a><ul class="nav nav-pills nav-stacked">
<li><a href="#identify-clusters-in-a-using-core">3.1 Identify clusters in a using CORE</a></li>
      <li><a href="#visualise-all-cluster-results-in-all-iterations">3.2 Visualise all cluster results in all iterations</a></li>
      <li><a href="#plot-the-optimal-clustering-result">3.3 Plot the optimal clustering result</a></li>
      <li><a href="#compare-clustering-results-with-other-dimensional-reduction-methods-e-g--cidr">3.4 Compare clustering results with other dimensional reduction methods (e.g., CIDR)</a></li>
      <li><a href="#find-gene-markers-and-annotate-clusters">3.5 Find gene markers and annotate clusters</a></li>
      </ul>
</li>
      <li>
<a href="#relationship-between-clusters-within-one-sample-or-between-two-samples">4. Relationship between clusters within one sample or between two samples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#start-the-scgps-prediction-to-find-relationship-between-clusters">4.1 Start the scGPS prediction to find relationship between clusters</a></li>
      <li><a href="#display-summary-results-for-the-prediction">4.2 Display summary results for the prediction</a></li>
      <li><a href="#plot-the-relationship-between-clusters">4.3 Plot the relationship between clusters</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Quan Nguyen, Anne Asenbouth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
